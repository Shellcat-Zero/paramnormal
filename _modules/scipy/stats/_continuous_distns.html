

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>scipy.stats._continuous_distns &mdash; paramnormal 0.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="paramnormal 0.2 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> paramnormal
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/overview.html">Why <code class="docutils literal"><span class="pre">paramnormal</span></code> ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/fitting.html">Fitting distributions to data with <code class="docutils literal"><span class="pre">paramnormal</span></code>.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/activities.html">Paramnormal Activity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../paramnormal.html">Probability Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utils.html">Miscellaneous Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../activity.html">Paramnormal Activities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">paramnormal</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
    <li>scipy.stats._continuous_distns</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for scipy.stats._continuous_distns</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Author:  Travis Oliphant  2002-2011 with contributions from</span>
<span class="c1">#          SciPy Developers 2004-2011</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">from</span> <span class="nn">scipy.misc.doccer</span> <span class="kn">import</span> <span class="n">inherit_docstring_from</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="p">(</span><span class="n">gammaln</span> <span class="k">as</span> <span class="n">gamln</span><span class="p">,</span> <span class="n">gamma</span> <span class="k">as</span> <span class="n">gam</span><span class="p">,</span> <span class="n">boxcox</span><span class="p">,</span> <span class="n">boxcox1p</span><span class="p">,</span>
                           <span class="n">inv_boxcox</span><span class="p">,</span> <span class="n">inv_boxcox1p</span><span class="p">,</span> <span class="n">erfc</span><span class="p">,</span> <span class="n">chndtr</span><span class="p">,</span> <span class="n">chndtrix</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">where</span><span class="p">,</span> <span class="n">arange</span><span class="p">,</span> <span class="n">putmask</span><span class="p">,</span> <span class="n">ravel</span><span class="p">,</span> <span class="nb">sum</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span>
                   <span class="n">log</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">arctanh</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">arcsin</span><span class="p">,</span> <span class="n">arctan</span><span class="p">,</span>
                   <span class="n">tanh</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">cosh</span><span class="p">,</span> <span class="n">sinh</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">polyval</span><span class="p">,</span> <span class="n">place</span><span class="p">,</span> <span class="n">extract</span><span class="p">,</span> <span class="nb">any</span><span class="p">,</span> <span class="n">asarray</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">pi</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">vonmises_cython</span>
<span class="kn">from</span> <span class="nn">._tukeylambda_stats</span> <span class="kn">import</span> <span class="p">(</span><span class="n">tukeylambda_variance</span> <span class="k">as</span> <span class="n">_tlvar</span><span class="p">,</span>
                                 <span class="n">tukeylambda_kurtosis</span> <span class="k">as</span> <span class="n">_tlkurt</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">._distn_infrastructure</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">rv_continuous</span><span class="p">,</span> <span class="n">valarray</span><span class="p">,</span> <span class="n">_skew</span><span class="p">,</span> <span class="n">_kurtosis</span><span class="p">,</span> <span class="n">_lazywhere</span><span class="p">,</span>
        <span class="n">_ncx2_log_pdf</span><span class="p">,</span> <span class="n">_ncx2_pdf</span><span class="p">,</span> <span class="n">_ncx2_cdf</span><span class="p">,</span> <span class="n">get_distribution_names</span><span class="p">,</span>
        <span class="p">)</span>

<span class="kn">from</span> <span class="nn">._constants</span> <span class="kn">import</span> <span class="n">_XMIN</span><span class="p">,</span> <span class="n">_EULER</span><span class="p">,</span> <span class="n">_ZETA3</span><span class="p">,</span> <span class="n">_XMAX</span><span class="p">,</span> <span class="n">_LOGXMAX</span>

<span class="c1">## Kolmogorov-Smirnov one-sided and two-sided test statistics</span>
<span class="k">class</span> <span class="nc">ksone_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;General Kolmogorov-Smirnov one-sided test.</span>

<span class="sd">    %(default)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">smirnov</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">smirnovi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">q</span><span class="p">)</span>
<span class="n">ksone</span> <span class="o">=</span> <span class="n">ksone_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ksone&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">kstwobign_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Kolmogorov-Smirnov two-sided test for large N.</span>

<span class="sd">    %(default)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">kolmogorov</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">kolmogorov</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">kolmogi</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">q</span><span class="p">)</span>
<span class="n">kstwobign</span> <span class="o">=</span> <span class="n">kstwobign_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;kstwobign&#39;</span><span class="p">)</span>


<span class="c1">## Normal distribution</span>

<span class="c1"># loc = mu, scale = std</span>
<span class="c1"># Keep these implementations out of the class definition so they can be reused</span>
<span class="c1"># by other distributions.</span>
<span class="n">_norm_pdf_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
<span class="n">_norm_pdf_logC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">_norm_pdf_C</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_norm_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">_norm_pdf_C</span>


<span class="k">def</span> <span class="nf">_norm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="n">_norm_pdf_logC</span>


<span class="k">def</span> <span class="nf">_norm_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_norm_logcdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">log_ndtr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtri</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_norm_sf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_norm_logsf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">log_ndtr</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_norm_isf</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">ndtri</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">norm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A normal continuous random variable.</span>

<span class="sd">    The location (loc) keyword specifies the mean.</span>
<span class="sd">    The scale (scale) keyword specifies the standard deviation.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `norm` is::</span>

<span class="sd">        norm.pdf(x) = exp(-x**2/2)/sqrt(2*pi)</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_logcdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_sf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logsf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_logsf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_isf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@inherit_docstring_from</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;%(super)s</span>
<span class="sd">        This function (norm_gen.fit) uses explicit formulas for the maximum</span>
<span class="sd">        likelihood estimation of the parameters, so the `optimizer` argument</span>
<span class="sd">        is ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">floc</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;floc&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">fscale</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fscale&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">floc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">fscale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># This check is for consistency with `rv_continuous.fit`.</span>
            <span class="c1"># Without this check, this function would just return the</span>
            <span class="c1"># parameters that were given.</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All parameters fixed. There is nothing to &quot;</span>
                             <span class="s2">&quot;optimize.&quot;</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">floc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="n">floc</span>

        <span class="k">if</span> <span class="n">fscale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">data</span> <span class="o">-</span> <span class="n">loc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">fscale</span>

        <span class="k">return</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span>

<span class="n">norm</span> <span class="o">=</span> <span class="n">norm_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">alpha_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An alpha continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `alpha` is::</span>

<span class="sd">        alpha.pdf(x, a) = 1/(x**2*Phi(a)*sqrt(2*pi)) * exp(-1/2 * (a-1/x)**2),</span>

<span class="sd">    where ``Phi(alpha)`` is the normal CDF, ``x &gt; 0``, and ``a &gt; 0``.</span>

<span class="sd">    `alpha` takes ``a`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">_norm_pdf</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">_norm_logpdf</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">ndtri</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">inf</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="n">nan</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">anglit_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An anglit continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `anglit` is::</span>

<span class="sd">        anglit.pdf(x) = sin(2*x + pi/2) = cos(2*x),</span>

<span class="sd">    for ``-pi/4 &lt;= x &lt;= pi/4``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q</span><span class="p">))</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">96</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">anglit</span> <span class="o">=</span> <span class="n">anglit_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;anglit&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">arcsine_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An arcsine continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `arcsine` is::</span>

<span class="sd">        arcsine.pdf(x) = 1/(pi*sqrt(x*(1-x)))</span>

<span class="sd">    for ``0 &lt; x &lt; 1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">8</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">0.24156447527049044468</span>
<span class="n">arcsine</span> <span class="o">=</span> <span class="n">arcsine_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;arcsine&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FitDataError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="c1"># This exception is raised by, for example, beta_gen.fit when both floc</span>
    <span class="c1"># and fscale  are fixed and there are values in the data not in the open</span>
    <span class="c1"># interval (floc, floc+fscale).</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distr</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Invalid values in `data`.  Maximum likelihood &quot;</span>
            <span class="s2">&quot;estimation with {distr!r} requires that {lower!r} &lt; x &quot;</span>
            <span class="s2">&quot;&lt; {upper!r} for each x in `data`.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">distr</span><span class="o">=</span><span class="n">distr</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">),</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">FitSolverError</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">):</span>
    <span class="c1"># This exception is raised by, for example, beta_gen.fit when</span>
    <span class="c1"># optimize.fsolve returns with ier != 1.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesg</span><span class="p">):</span>
        <span class="n">emsg</span> <span class="o">=</span> <span class="s2">&quot;Solver for the MLE equations failed to converge: &quot;</span>
        <span class="n">emsg</span> <span class="o">+=</span> <span class="n">mesg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">emsg</span><span class="p">,)</span>


<span class="k">def</span> <span class="nf">_beta_mle_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s1</span><span class="p">):</span>
    <span class="c1"># The zeros of this function give the MLE for `a`, with</span>
    <span class="c1"># `b`, `n` and `s1` given.  `s1` is the sum of the logs of</span>
    <span class="c1"># the data. `n` is the number of data points.</span>
    <span class="n">psiab</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">psiab</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">func</span>


<span class="k">def</span> <span class="nf">_beta_mle_ab</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
    <span class="c1"># Zeros of this function are critical points of</span>
    <span class="c1"># the maximum likelihood function.  Solving this system</span>
    <span class="c1"># for theta (which contains a and b) gives the MLE for a and b</span>
    <span class="c1"># given `n`, `s1` and `s2`.  `s1` is the sum of the logs of the data,</span>
    <span class="c1"># and `s2` is the sum of the logs of 1 - data.  `n` is the number</span>
    <span class="c1"># of data points.</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">theta</span>
    <span class="n">psiab</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">func</span> <span class="o">=</span> <span class="p">[</span><span class="n">s1</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">psiab</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span>
            <span class="n">s2</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">psiab</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">b</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">func</span>


<span class="k">class</span> <span class="nc">beta_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A beta continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `beta` is::</span>

<span class="sd">                            gamma(a+b) * x**(a-1) * (1-x)**(b-1)</span>
<span class="sd">        beta.pdf(x, a, b) = ------------------------------------</span>
<span class="sd">                                     gamma(a)*gamma(b)</span>

<span class="sd">    for ``0 &lt; x &lt; 1``, ``a &gt; 0``, ``b &gt; 0``, where ``gamma(z)`` is the gamma</span>
<span class="sd">    function (`scipy.special.gamma`).</span>

<span class="sd">    `beta` takes ``a`` and ``b`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">lPx</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">xlog1py</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">lPx</span> <span class="o">-=</span> <span class="n">special</span><span class="o">.</span><span class="n">betaln</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lPx</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">btdtr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">btdtri</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">mn</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">var</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">1.0</span><span class="o">+</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="mf">6.0</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="p">))</span>
        <span class="n">g2</span> <span class="o">/=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mn</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_fitstart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">_skew</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">_kurtosis</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">sk</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
            <span class="n">ku</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ku</span> <span class="o">/=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">ku</span> <span class="o">*=</span> <span class="mi">6</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">sk</span><span class="o">-</span><span class="n">g1</span><span class="p">,</span> <span class="n">ku</span><span class="o">-</span><span class="n">g2</span><span class="p">]</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">beta_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_fitstart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="nd">@inherit_docstring_from</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;%(super)s</span>
<span class="sd">        In the special case where both `floc` and `fscale` are given, a</span>
<span class="sd">        `ValueError` is raised if any value `x` in `data` does not satisfy</span>
<span class="sd">        `floc &lt; x &lt; floc + fscale`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Override rv_continuous.fit, so we can more efficiently handle the</span>
        <span class="c1"># case where floc and fscale are given.</span>

        <span class="n">f0</span> <span class="o">=</span> <span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fa&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span>
              <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fb&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span>
              <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_b&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">floc</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;floc&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">fscale</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fscale&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">floc</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">fscale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># do general fit</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">beta_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">f0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">f1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># This check is for consistency with `rv_continuous.fit`.</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All parameters fixed. There is nothing to &quot;</span>
                             <span class="s2">&quot;optimize.&quot;</span><span class="p">)</span>

        <span class="c1"># Special case: loc and scale are constrained, so we are fitting</span>
        <span class="c1"># just the shape parameters.  This can be done much more efficiently</span>
        <span class="c1"># than the method used in `rv_continuous.fit`.  (See the subsection</span>
        <span class="c1"># &quot;Two unknown parameters&quot; in the section &quot;Maximum likelihood&quot; of</span>
        <span class="c1"># the Wikipedia article on the Beta distribution for the formulas.)</span>

        <span class="c1"># Normalize the data to the interval [0, 1].</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">ravel</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">floc</span><span class="p">)</span> <span class="o">/</span> <span class="n">fscale</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FitDataError</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">floc</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">floc</span> <span class="o">+</span> <span class="n">fscale</span><span class="p">)</span>
        <span class="n">xbar</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">f0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">f1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># One of the shape parameters is fixed.</span>

            <span class="k">if</span> <span class="n">f0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># The shape parameter a is fixed, so swap the parameters</span>
                <span class="c1"># and flip the data.  We always solve for `a`.  The result</span>
                <span class="c1"># will be swapped back before returning.</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">f0</span>
                <span class="n">data</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span>
                <span class="n">xbar</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xbar</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">f1</span>

            <span class="c1"># Initial guess for a.  Use the formula for the mean of the beta</span>
            <span class="c1"># distribution, E[x] = a / (a + b), to generate a reasonable</span>
            <span class="c1"># starting point based on the mean of the data and the given</span>
            <span class="c1"># value of b.</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">xbar</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">)</span>

            <span class="c1"># Compute the MLE for `a` by solving _beta_mle_a.</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span>
                <span class="n">_beta_mle_a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span>
                <span class="n">full_output</span><span class="o">=</span><span class="bp">True</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ier</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FitSolverError</span><span class="p">(</span><span class="n">mesg</span><span class="o">=</span><span class="n">mesg</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">f0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># The shape parameter a was fixed, so swap back the</span>
                <span class="c1"># parameters.</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Neither of the shape parameters is fixed.</span>

            <span class="c1"># s1 and s2 are used in the extra arguments passed to _beta_mle_ab</span>
            <span class="c1"># by optimize.fsolve.</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

            <span class="c1"># Use the &quot;method of moments&quot; to estimate the initial</span>
            <span class="c1"># guess for a and b.</span>
            <span class="n">fac</span> <span class="o">=</span> <span class="n">xbar</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">)</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">xbar</span> <span class="o">*</span> <span class="n">fac</span>
            <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span>

            <span class="c1"># Compute the MLE for a and b by solving _beta_mle_ab.</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span>
                <span class="n">_beta_mle_ab</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">),</span>
                <span class="n">full_output</span><span class="o">=</span><span class="bp">True</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ier</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FitSolverError</span><span class="p">(</span><span class="n">mesg</span><span class="o">=</span><span class="n">mesg</span><span class="p">)</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">theta</span>

        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">floc</span><span class="p">,</span> <span class="n">fscale</span>

<span class="n">beta</span> <span class="o">=</span> <span class="n">beta_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">betaprime_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A beta prime continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `betaprime` is::</span>

<span class="sd">        betaprime.pdf(x, a, b) = x**(a-1) * (1+x)**(-a-b) / beta(a, b)</span>

<span class="sd">    for ``x &gt; 0``, ``a &gt; 0``, ``b &gt; 0``, where ``beta(a, b)`` is the beta</span>
<span class="sd">    function (see `scipy.special.beta`).</span>

<span class="sd">    `betaprime` takes ``a`` and ``b`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">sz</span><span class="p">,</span> <span class="n">rndm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>
        <span class="n">u1</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">)</span>
        <span class="n">u2</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">u1</span> <span class="o">/</span> <span class="n">u2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">xlog1py</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span>
                <span class="n">special</span><span class="o">.</span><span class="n">betaln</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">betainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">inf</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mf">2.0</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span> <span class="n">inf</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">2.0</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span>
                         <span class="n">inf</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mf">4.0</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span>
                         <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">3.0</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">3.0</span><span class="p">)</span>
                                                    <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span> <span class="n">inf</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<span class="n">betaprime</span> <span class="o">=</span> <span class="n">betaprime_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;betaprime&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">bradford_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Bradford continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `bradford` is::</span>

<span class="sd">        bradford.pdf(x, c) = c / (k * (1+c*x)),</span>

<span class="sd">    for ``0 &lt; x &lt; 1``, ``c &gt; 0`` and ``k = log(1+c)``.</span>

<span class="sd">    `bradford` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="mf">1.0</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mv&#39;</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">c</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span><span class="o">+</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="o">-</span><span class="mi">9</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span>
            <span class="n">g1</span> <span class="o">/=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;k&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
                  <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">14</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">g2</span> <span class="o">/=</span> <span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">k</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
<span class="n">bradford</span> <span class="o">=</span> <span class="n">bradford_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bradford&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">burr_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Burr (Type III) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    fisk : a special case of `burr` with ``d = 1``</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `burr` is::</span>

<span class="sd">        burr.pdf(x, c, d) = c * d * x**(-c-1) * (1+x**(-c))**(-d-1)</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `burr` takes ``c`` and ``d`` as shape parameters.</span>

<span class="sd">    This is the PDF corresponding to the third CDF given in Burr&#39;s list;</span>
<span class="sd">    specifically, it is equation (11) in Burr&#39;s paper [1]_.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Burr, I. W. &quot;Cumulative frequency functions&quot;, Annals of</span>
<span class="sd">       Mathematical Statistics, 13(2), pp 215-232 (1942).</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="mf">1.0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="mf">1.0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="o">**</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">q</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">c</span>
        <span class="k">return</span> <span class="n">d</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nc</span><span class="p">,</span> <span class="n">d</span> <span class="o">+</span> <span class="n">nc</span><span class="p">)</span>
<span class="n">burr</span> <span class="o">=</span> <span class="n">burr_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;burr&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">fisk_gen</span><span class="p">(</span><span class="n">burr_gen</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Fisk continuous random variable.</span>

<span class="sd">    The Fisk distribution is also known as the log-logistic distribution, and</span>
<span class="sd">    equals the Burr distribution with ``d == 1``.</span>

<span class="sd">    `fisk` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `fisk` is::</span>

<span class="sd">        fisk.pdf(x, c) = c * x**(-c-1) * (1 + x**(-c))**(-2)</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `fisk` takes ``c`` as a shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    burr</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">burr_gen</span><span class="o">.</span><span class="n">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">burr_gen</span><span class="o">.</span><span class="n">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">burr_gen</span><span class="o">.</span><span class="n">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">burr_gen</span><span class="o">.</span><span class="n">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">fisk</span> <span class="o">=</span> <span class="n">fisk_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;fisk&#39;</span><span class="p">)</span>


<span class="c1"># median = loc</span>
<span class="k">class</span> <span class="nc">cauchy_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Cauchy continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `cauchy` is::</span>

<span class="sd">        cauchy.pdf(x) = 1 / (pi * (1 + x**2))</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fitstart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># Initialize ML guesses using quartiles instead of moments.</span>
        <span class="n">p25</span><span class="p">,</span> <span class="n">p50</span><span class="p">,</span> <span class="n">p75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">p50</span><span class="p">,</span> <span class="p">(</span><span class="n">p75</span> <span class="o">-</span> <span class="n">p25</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">cauchy</span> <span class="o">=</span> <span class="n">cauchy_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;cauchy&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">chi_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A chi continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `chi` is::</span>

<span class="sd">        chi.pdf(x, df) = x**(df-1) * exp(-x**2/2) / (2**(df/2-1) * gamma(df/2))</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    Special cases of `chi` are:</span>

<span class="sd">        - ``chi(1, loc, scale)`` is equivalent to `halfnorm`</span>
<span class="sd">        - ``chi(2, 0, scale)`` is equivalent to `rayleigh`</span>
<span class="sd">        - ``chi(3, 0, scale)`` is equivalent to `maxwell`</span>

<span class="sd">    `chi` takes ``df`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">sz</span><span class="p">,</span> <span class="n">rndm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">chi2</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">df</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">df</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">l</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">df</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">df</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.0</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">df</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">mu</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mf">3.0</span> <span class="o">+</span> <span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">df</span><span class="p">))</span><span class="o">/</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">df</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">df</span><span class="p">)</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">df</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">/=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">mu2</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">chi</span> <span class="o">=</span> <span class="n">chi_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;chi&#39;</span><span class="p">)</span>


<span class="c1">## Chi-squared (gamma-distributed with loc=0 and scale=2 and shape=df/2)</span>
<span class="k">class</span> <span class="nc">chi2_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A chi-squared continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `chi2` is::</span>

<span class="sd">        chi2.pdf(x, df) = 1 / (2*gamma(df/2)) * (x/2)**(df/2-1) * exp(-x/2)</span>

<span class="sd">    `chi2` takes ``df`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">/</span><span class="mf">2.</span> <span class="o">-</span> <span class="n">gamln</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">chdtr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">chdtrc</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">chdtri</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isf</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">df</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">df</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">df</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="mf">12.0</span><span class="o">/</span><span class="n">df</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;chi2&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">cosine_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A cosine continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The cosine distribution is an approximation to the normal distribution.</span>
<span class="sd">    The probability density function for `cosine` is::</span>

<span class="sd">        cosine.pdf(x) = 1/(2*pi) * (1+cos(x))</span>

<span class="sd">    for ``-pi &lt;= x &lt;= pi``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.0</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">4</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0</span>
<span class="n">cosine</span> <span class="o">=</span> <span class="n">cosine_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">pi</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">dgamma_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A double gamma continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `dgamma` is::</span>

<span class="sd">        dgamma.pdf(x, a) = 1 / (2*gamma(a)) * abs(x)**(a-1) * exp(-abs(x))</span>

<span class="sd">    for ``a &gt; 0``.</span>

<span class="sd">    `dgamma` takes ``a`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">sz</span><span class="p">,</span> <span class="n">rndm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">rndm</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">)</span>
        <span class="n">gm</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">where</span><span class="p">(</span><span class="n">u</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="o">*</span><span class="n">ax</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">-</span> <span class="n">ax</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">gamln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">fac</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">fac</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">-</span><span class="n">fac</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">+</span><span class="n">fac</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainccinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">fac</span><span class="p">,</span> <span class="o">-</span><span class="n">fac</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">3.0</span><span class="p">)</span><span class="o">/</span><span class="n">mu2</span><span class="o">-</span><span class="mf">3.0</span>
<span class="n">dgamma</span> <span class="o">=</span> <span class="n">dgamma_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;dgamma&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">dweibull_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A double Weibull continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `dweibull` is::</span>

<span class="sd">        dweibull.pdf(x, c) = c / 2 * abs(x)**(c-1) * exp(-abs(x)**c)</span>

<span class="sd">    `dweibull` takes ``d`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">sz</span><span class="p">,</span> <span class="n">rndm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">rndm</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">weibull_min</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">u</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">ax</span><span class="o">**</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ax</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Px</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">-</span> <span class="n">ax</span><span class="o">**</span><span class="n">c</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">Cx1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Cx1</span><span class="p">,</span> <span class="n">Cx1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">fac</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">fac</span><span class="p">,</span> <span class="o">-</span><span class="n">fac</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span>

    <span class="c1"># since we know that all odd moments are zeros, return them at once.</span>
    <span class="c1"># returning Nones from _stats makes the public stats call _munp</span>
    <span class="c1"># so overall we&#39;re saving one or two gamma function evaluations here.</span>
    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span>
<span class="n">dweibull</span> <span class="o">=</span> <span class="n">dweibull_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;dweibull&#39;</span><span class="p">)</span>


<span class="c1">## Exponential (gamma distributed with a=1.0, loc=loc and scale=scale)</span>
<span class="k">class</span> <span class="nc">expon_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An exponential continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `expon` is::</span>

<span class="sd">        expon.pdf(x) = exp(-x)</span>

<span class="sd">    for ``x &gt;= 0``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    A common parameterization for `expon` is in terms of the rate parameter</span>
<span class="sd">    ``lambda``, such that ``pdf = lambda * exp(-lambda * x)``. This</span>
<span class="sd">    parameterization corresponds to using ``scale = 1 / lambda``.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_exponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logsf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">6.0</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span>
<span class="n">expon</span> <span class="o">=</span> <span class="n">expon_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;expon&#39;</span><span class="p">)</span>


<span class="c1">## Exponentially Modified Normal (exponential distribution</span>
<span class="c1">##  convolved with a Normal).</span>
<span class="c1">## This is called an exponentially modified gaussian on wikipedia</span>
<span class="k">class</span> <span class="nc">exponnorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An exponentially modified Normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `exponnorm` is::</span>

<span class="sd">        exponnorm.pdf(x, K) = 1/(2*K) exp(1/(2 * K**2)) exp(-x / K) * erfc(-(x - 1/K) / sqrt(2))</span>

<span class="sd">    where the shape parameter ``K &gt; 0``.</span>

<span class="sd">    It can be thought of as the sum of a normally distributed random</span>
<span class="sd">    value with mean ``loc`` and sigma ``scale`` and an exponentially</span>
<span class="sd">    distributed random number with a pdf proportional to ``exp(-lambda * x)``</span>
<span class="sd">    where ``lambda = (K * scale)**(-1)``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    An alternative parameterization of this distribution (for example, in</span>
<span class="sd">    `Wikipedia &lt;http://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution&gt;`_)</span>
<span class="sd">    involves three parameters, :math:`\mu`, :math:`\lambda` and :math:`\sigma`.</span>
<span class="sd">    In the present parameterization this corresponds to having ``loc`` and</span>
<span class="sd">    ``scale`` equal to :math:`\mu` and :math:`\sigma`, respectively, and</span>
<span class="sd">    shape parameter :math:`K = 1/\sigma\lambda`.</span>

<span class="sd">    .. versionadded:: 0.16.0</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">expval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_exponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">K</span>
        <span class="n">gval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expval</span> <span class="o">+</span> <span class="n">gval</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">invK</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">K</span>
        <span class="n">exparg</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">invK</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">invK</span> <span class="o">*</span> <span class="n">x</span>
        <span class="c1"># Avoid overflows; setting exp(exparg) to the max float works</span>
        <span class="c1">#  all right here</span>
        <span class="n">expval</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">exparg</span> <span class="o">&lt;</span> <span class="n">_LOGXMAX</span><span class="p">,</span> <span class="p">(</span><span class="n">exparg</span><span class="p">,),</span> <span class="n">exp</span><span class="p">,</span> <span class="n">_XMAX</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">invK</span> <span class="o">*</span> <span class="n">expval</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">invK</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">invK</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">K</span>
        <span class="n">exparg</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">invK</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">invK</span> <span class="o">*</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">exparg</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">invK</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">invK</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">invK</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">K</span>
        <span class="n">expval</span> <span class="o">=</span> <span class="n">invK</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">invK</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">expval</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">invK</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">invK</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">K</span>
        <span class="n">expval</span> <span class="o">=</span> <span class="n">invK</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">invK</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">expval</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">invK</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">K2</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*</span> <span class="n">K</span>
        <span class="n">opK2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">K2</span>
        <span class="n">skw</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">K</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">opK2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">krt</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">*</span> <span class="n">K2</span> <span class="o">*</span> <span class="n">K2</span> <span class="o">*</span> <span class="n">opK2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">K</span><span class="p">,</span> <span class="n">opK2</span><span class="p">,</span> <span class="n">skw</span><span class="p">,</span> <span class="n">krt</span>
<span class="n">exponnorm</span> <span class="o">=</span> <span class="n">exponnorm_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;exponnorm&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">exponweib_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An exponentiated Weibull continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `exponweib` is::</span>

<span class="sd">        exponweib.pdf(x, a, c) =</span>
<span class="sd">            a * c * (1-exp(-x**c))**(a-1) * exp(-x**c)*x**(c-1)</span>

<span class="sd">    for ``x &gt; 0``, ``a &gt; 0``, ``c &gt; 0``.</span>

<span class="sd">    `exponweib` takes ``a`` and ``c`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">negxc</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="n">c</span>
        <span class="n">exm1c</span> <span class="o">=</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">negxc</span><span class="p">)</span>
        <span class="n">logp</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">exm1c</span><span class="p">)</span> <span class="o">+</span>
                <span class="n">negxc</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">logp</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">exm1c</span> <span class="o">=</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exm1c</span><span class="o">**</span><span class="n">a</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">a</span><span class="p">)))</span><span class="o">**</span><span class="n">asarray</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
<span class="n">exponweib</span> <span class="o">=</span> <span class="n">exponweib_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;exponweib&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">exponpow_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An exponential power continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `exponpow` is::</span>

<span class="sd">        exponpow.pdf(x, b) = b * x**(b-1) * exp(1 + x**b - exp(x**b))</span>

<span class="sd">    for ``x &gt;= 0``, ``b &gt; 0``.  Note that this is a different distribution</span>
<span class="sd">    from the exponential power distribution that is also known under the names</span>
<span class="sd">    &quot;generalized normal&quot; or &quot;generalized Gaussian&quot;.</span>

<span class="sd">    `exponpow` takes ``b`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    http://www.math.wm.edu/~leemis/chart/UDR/PDFs/Exponentialpower.pdf</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">xb</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">b</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">xb</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)),</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>
<span class="n">exponpow</span> <span class="o">=</span> <span class="n">exponpow_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;exponpow&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">fatiguelife_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A fatigue-life (Birnbaum-Saunders) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `fatiguelife` is::</span>

<span class="sd">        fatiguelife.pdf(x, c) =</span>
<span class="sd">            (x+1) / (2*c*sqrt(2*pi*x**3)) * exp(-(x-1)**2/(2*x*c**2))</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `fatiguelife` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] &quot;Birnbaum-Saunders distribution&quot;,</span>
<span class="sd">           http://en.wikipedia.org/wiki/Birnbaum-Saunders_distribution</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">z</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span>
                <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">ndtri</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">tmp</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="c1"># NB: the formula for kurtosis in wikipedia seems to have an error:</span>
        <span class="c1"># it&#39;s 40, not 41. At least it disagrees with the one from Wolfram</span>
        <span class="c1"># Alpha.  And the latter one, below, passes the tests, while the wiki</span>
        <span class="c1"># one doesn&#39;t So far I didn&#39;t have the guts to actually check the</span>
        <span class="c1"># coefficients from the expressions for the raw moments.</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">c</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">+</span> <span class="mf">4.0</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">*</span><span class="n">den</span> <span class="o">/</span> <span class="mf">4.0</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">den</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">93</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="mf">40.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">den</span><span class="o">**</span><span class="mf">2.0</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">fatiguelife</span> <span class="o">=</span> <span class="n">fatiguelife_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;fatiguelife&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">foldcauchy_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A folded Cauchy continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `foldcauchy` is::</span>

<span class="sd">        foldcauchy.pdf(x, c) = 1/(pi*(1+(x-c)**2)) + 1/(pi*(1+(x+c)**2))</span>

<span class="sd">    for ``x &gt;= 0``.</span>

<span class="sd">    `foldcauchy` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cauchy</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span>
                              <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span>
<span class="n">foldcauchy</span> <span class="o">=</span> <span class="n">foldcauchy_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;foldcauchy&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">f_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An F continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `f` is::</span>

<span class="sd">                             df2**(df2/2) * df1**(df1/2) * x**(df1/2-1)</span>
<span class="sd">        F.pdf(x, df1, df2) = --------------------------------------------</span>
<span class="sd">                             (df2+df1*x)**((df1+df2)/2) * B(df1/2, df2/2)</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `f` takes ``dfn`` and ``dfd`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">dfn</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">dfd</span>
        <span class="n">lPx</span> <span class="o">=</span> <span class="n">m</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">lPx</span> <span class="o">-=</span> <span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">betaln</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lPx</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">fdtr</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">fdtrc</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">fdtri</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">):</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">dfn</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">dfd</span>
        <span class="n">v2_2</span><span class="p">,</span> <span class="n">v2_4</span><span class="p">,</span> <span class="n">v2_6</span><span class="p">,</span> <span class="n">v2_8</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">v2</span> <span class="o">-</span> <span class="mf">4.</span><span class="p">,</span> <span class="n">v2</span> <span class="o">-</span> <span class="mf">6.</span><span class="p">,</span> <span class="n">v2</span> <span class="o">-</span> <span class="mf">8.</span>

        <span class="n">mu</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span>
            <span class="n">v2</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">v2_2</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v2_2</span><span class="p">:</span> <span class="n">v2</span> <span class="o">/</span> <span class="n">v2_2</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

        <span class="n">mu2</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span>
            <span class="n">v2</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v2_2</span><span class="p">,</span> <span class="n">v2_4</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v2_2</span><span class="p">,</span> <span class="n">v2_4</span><span class="p">:</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="n">v2</span> <span class="o">*</span> <span class="n">v2</span> <span class="o">*</span> <span class="p">(</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2_2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">v1</span> <span class="o">*</span> <span class="n">v2_2</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v2_4</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

        <span class="n">g1</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span>
            <span class="n">v2</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2_2</span><span class="p">,</span> <span class="n">v2_4</span><span class="p">,</span> <span class="n">v2_6</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2_2</span><span class="p">,</span> <span class="n">v2_4</span><span class="p">,</span> <span class="n">v2_6</span><span class="p">:</span>
            <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">v2_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">v2_6</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">v2_4</span> <span class="o">/</span> <span class="p">(</span><span class="n">v1</span> <span class="o">*</span> <span class="p">(</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2_2</span><span class="p">))),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">8.</span><span class="p">)</span>

        <span class="n">g2</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span>
            <span class="n">v2</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">v2_6</span><span class="p">,</span> <span class="n">v2_8</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">g1</span><span class="p">,</span> <span class="n">v2_6</span><span class="p">,</span> <span class="n">v2_8</span><span class="p">:</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">g1</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">*</span> <span class="n">v2_6</span><span class="p">)</span> <span class="o">/</span> <span class="n">v2_8</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">*=</span> <span class="mf">3.</span> <span class="o">/</span> <span class="mf">2.</span>

        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">f_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>


<span class="c1">## Folded Normal</span>
<span class="c1">##   abs(Z) where (Z is normal with mu=L and std=S so that c=abs(L)/S)</span>
<span class="c1">##</span>
<span class="c1">##  note: regress docs have scale parameter correct, but first parameter</span>
<span class="c1">##    he gives is a shape parameter A = c * scale</span>

<span class="c1">##  Half-normal is folded normal with shape-parameter c=0.</span>

<span class="k">class</span> <span class="nc">foldnorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A folded normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `foldnorm` is::</span>

<span class="sd">        foldnormal.pdf(x, c) = sqrt(2/pi) * cosh(c*x) * exp(-(x**2+c**2)/2)</span>

<span class="sd">    for ``c &gt;= 0``.</span>

<span class="sd">    `foldnorm` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="c1"># Regina C. Elandt, Technometrics 3, 551 (1961)</span>
        <span class="c1"># http://www.jstor.org/stable/1266561</span>
        <span class="c1">#</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">c</span>
        <span class="n">expfac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>

        <span class="n">mu</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">expfac</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">mu</span>

        <span class="n">g1</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">mu</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="n">mu</span> <span class="o">-</span> <span class="n">expfac</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

        <span class="n">g2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="p">(</span><span class="n">c2</span> <span class="o">+</span> <span class="mf">6.</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mf">8.</span><span class="o">*</span><span class="n">expfac</span><span class="o">*</span><span class="n">mu</span>
        <span class="n">g2</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">g2</span> <span class="o">/</span> <span class="n">mu2</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">3.</span>

        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">foldnorm</span> <span class="o">=</span> <span class="n">foldnorm_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;foldnorm&#39;</span><span class="p">)</span>


<span class="c1">## Extreme Value Type II or Frechet</span>
<span class="c1">## (defined in Regress+ documentation as Extreme LB) as</span>
<span class="c1">##   a limiting value distribution.</span>
<span class="c1">##</span>
<span class="k">class</span> <span class="nc">frechet_r_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Frechet right (or Weibull minimum) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    weibull_min : The same distribution as `frechet_r`.</span>
<span class="sd">    frechet_l, weibull_max</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `frechet_r` is::</span>

<span class="sd">        frechet_r.pdf(x, c) = c * x**(c-1) * exp(-x**c)</span>

<span class="sd">    for ``x &gt; 0``, ``c &gt; 0``.</span>

<span class="sd">    `frechet_r` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">),</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_EULER</span> <span class="o">/</span> <span class="n">c</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">_EULER</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">frechet_r</span> <span class="o">=</span> <span class="n">frechet_r_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;frechet_r&#39;</span><span class="p">)</span>
<span class="n">weibull_min</span> <span class="o">=</span> <span class="n">frechet_r_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;weibull_min&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">frechet_l_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Frechet left (or Weibull maximum) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    weibull_max : The same distribution as `frechet_l`.</span>
<span class="sd">    frechet_r, weibull_min</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `frechet_l` is::</span>

<span class="sd">        frechet_l.pdf(x, c) = c * (-x)**(c-1) * exp(-(-x)**c)</span>

<span class="sd">    for ``x &lt; 0``, ``c &gt; 0``.</span>

<span class="sd">    `frechet_l` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">sgn</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sgn</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">sgn</span> <span class="o">*</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_EULER</span> <span class="o">/</span> <span class="n">c</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">_EULER</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">frechet_l</span> <span class="o">=</span> <span class="n">frechet_l_gen</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;frechet_l&#39;</span><span class="p">)</span>
<span class="n">weibull_max</span> <span class="o">=</span> <span class="n">frechet_l_gen</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;weibull_max&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">genlogistic_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized logistic continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `genlogistic` is::</span>

<span class="sd">        genlogistic.pdf(x, c) = c * exp(-x) / (1 + exp(-x))**(c+1)</span>

<span class="sd">    for ``x &gt; 0``, ``c &gt; 0``.</span>

<span class="sd">    `genlogistic` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">Cx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Cx</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vals</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">zeta</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">_EULER</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">6.0</span> <span class="o">+</span> <span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">_ZETA3</span>
        <span class="n">g1</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">pi</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mf">15.0</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">zeta</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">/=</span> <span class="n">mu2</span><span class="o">**</span><span class="mf">2.0</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">genlogistic</span> <span class="o">=</span> <span class="n">genlogistic_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;genlogistic&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">genpareto_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized Pareto continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `genpareto` is::</span>

<span class="sd">        genpareto.pdf(x, c) = (1 + c * x)**(-1 - 1/c)</span>

<span class="sd">    defined for ``x &gt;= 0`` if ``c &gt;=0``, and for</span>
<span class="sd">    ``0 &lt;= x &lt;= -1/c`` if ``c &lt; 0``.</span>

<span class="sd">    `genpareto` takes ``c`` as a shape parameter.</span>

<span class="sd">    For ``c == 0``, `genpareto` reduces to the exponential</span>
<span class="sd">    distribution, `expon`::</span>

<span class="sd">        genpareto.pdf(x, c=0) = exp(-x)</span>

<span class="sd">    For ``c == -1``, `genpareto` is uniform on ``[0, 1]``::</span>

<span class="sd">        genpareto.cdf(x, c=-1) = x</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="p">,),</span>
                <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_lazywhere</span><span class="p">((</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">xlog1py</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span>
            <span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">inv_boxcox1p</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inv_boxcox</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logsf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_lazywhere</span><span class="p">((</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span>
            <span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">boxcox1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">boxcox</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">__munp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ki</span><span class="p">,</span> <span class="n">cnk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">cnk</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">ki</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">ki</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">val</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="n">n</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="p">,),</span>
                <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">__munp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span>
                <span class="n">gam</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">c</span>
<span class="n">genpareto</span> <span class="o">=</span> <span class="n">genpareto_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;genpareto&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">genexpon_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized exponential continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `genexpon` is::</span>

<span class="sd">        genexpon.pdf(x, a, b, c) = (a + b * (1 - exp(-c*x))) * \</span>
<span class="sd">                                   exp(-a*x - b*x + b/c * (1-exp(-c*x)))</span>

<span class="sd">    for ``x &gt;= 0``, ``a, b, c &gt; 0``.</span>

<span class="sd">    `genexpon` takes ``a``, ``b`` and ``c`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    H.K. Ryu, &quot;An Extension of Marshall and Olkin&#39;s Bivariate Exponential</span>
<span class="sd">    Distribution&quot;, Journal of the American Statistical Association, 1993.</span>

<span class="sd">     N. Balakrishnan, &quot;The Exponential Distribution: Theory, Methods and</span>
<span class="sd">     Applications&quot;, Asit P. Basu.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)))</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span>
            <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">((</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)))</span> <span class="o">+</span> \
                <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">c</span>
<span class="n">genexpon</span> <span class="o">=</span> <span class="n">genexpon_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;genexpon&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">genextreme_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized extreme value continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gumbel_r</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For ``c=0``, `genextreme` is equal to `gumbel_r`.</span>
<span class="sd">    The probability density function for `genextreme` is::</span>

<span class="sd">        genextreme.pdf(x, c) =</span>
<span class="sd">            exp(-exp(-x))*exp(-x),                    for c==0</span>
<span class="sd">            exp(-(1-c*x)**(1/c))*(1-c*x)**(1/c-1),    for x &lt;= 1/c, c &gt; 0</span>

<span class="sd">    Note that several sources and software packages use the opposite</span>
<span class="sd">    convention for the sign of the shape parameter ``c``.</span>

<span class="sd">    `genextreme` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="nb">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">_XMIN</span><span class="p">),</span> <span class="n">inf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">_XMIN</span><span class="p">),</span> <span class="o">-</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">x</span>
        <span class="n">logex2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">cx</span><span class="p">))</span>
        <span class="n">logpex2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">logex2</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
        <span class="n">pex2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">logpex2</span><span class="p">)</span>
        <span class="c1"># Handle special cases</span>
        <span class="n">logpdf</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">cx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">cx</span> <span class="o">==</span> <span class="o">-</span><span class="n">inf</span><span class="p">),</span> <span class="o">-</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">pex2</span><span class="o">+</span><span class="n">logpex2</span><span class="o">-</span><span class="n">logex2</span><span class="p">)</span>
        <span class="n">putmask</span><span class="p">(</span><span class="n">logpdf</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">logpdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">loglogcdf</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">loglogcdf</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">((</span><span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">gam</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">g3</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">g4</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">g2mg12</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">g2</span><span class="o">-</span><span class="n">g1</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">gam2k</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="n">pi</span><span class="o">**</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">6.0</span><span class="p">,</span>
                      <span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">gamln</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamln</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mf">1.0</span><span class="p">))</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-14</span>
        <span class="n">gamk</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">,</span> <span class="o">-</span><span class="n">_EULER</span><span class="p">,</span> <span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">gamln</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="n">gamk</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">g1</span><span class="o">**</span><span class="mf">2.0</span><span class="o">*</span><span class="n">gam2k</span><span class="p">)</span>

        <span class="c1"># skewness</span>
        <span class="n">sk1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">g3</span><span class="o">+</span><span class="p">(</span><span class="n">g2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">g2mg12</span><span class="p">)</span><span class="o">*</span><span class="n">g1</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">g2mg12</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">3.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)))</span>
        <span class="n">sk</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">eps</span><span class="o">**</span><span class="mf">0.29</span><span class="p">,</span> <span class="mi">12</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">_ZETA3</span><span class="o">/</span><span class="n">pi</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">sk1</span><span class="p">)</span>

        <span class="c1"># kurtosis</span>
        <span class="n">ku1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">g4</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">g3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">g2</span><span class="o">+</span><span class="n">g2mg12</span><span class="p">)</span><span class="o">*</span><span class="n">g1</span><span class="p">)</span><span class="o">*</span><span class="n">g1</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">g2mg12</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ku</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="o">**</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">12.0</span><span class="o">/</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">ku1</span><span class="o">-</span><span class="mf">3.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sk</span><span class="p">,</span> <span class="n">ku</span>

    <span class="k">def</span> <span class="nf">_fitstart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># This is better than the default shape of (1,).</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">_skew</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">genextreme_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_fitstart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">n</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_EULER</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">genextreme</span> <span class="o">=</span> <span class="n">genextreme_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;genextreme&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_digammainv</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="c1"># Inverse of the digamma function (real positive arguments only).</span>
    <span class="c1"># This function is used in the `fit` method of `gamma_gen`.</span>
    <span class="c1"># The function uses either optimize.fsolve or optimize.newton</span>
    <span class="c1"># to solve `digamma(x) - y = 0`.  There is probably room for</span>
    <span class="c1"># improvement, but currently it works over a wide range of y:</span>
    <span class="c1">#    &gt;&gt;&gt; y = 64*np.random.randn(1000000)</span>
    <span class="c1">#    &gt;&gt;&gt; y.min(), y.max()</span>
    <span class="c1">#    (-311.43592651416662, 351.77388222276869)</span>
    <span class="c1">#    x = [_digammainv(t) for t in y]</span>
    <span class="c1">#    np.abs(digamma(x) - y).max()</span>
    <span class="c1">#    1.1368683772161603e-13</span>
    <span class="c1">#</span>
    <span class="n">_em</span> <span class="o">=</span> <span class="mf">0.5772156649015328606065120</span>
    <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">special</span><span class="o">.</span><span class="n">digamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">0.125</span><span class="p">:</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="c1"># Some experimentation shows that newton reliably converges</span>
            <span class="c1"># must faster than fsolve in this y range.  For larger y,</span>
            <span class="c1"># newton sometimes fails to converge.</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="mf">2.332</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.08661</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="n">y</span> <span class="o">-</span> <span class="n">_em</span><span class="p">)</span>

    <span class="n">value</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-11</span><span class="p">,</span>
                                             <span class="n">full_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ier</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;_digammainv: fsolve failed, y = </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="c1">## Gamma (Use MATLAB and MATHEMATICA (b=theta=scale, a=alpha=shape) definition)</span>

<span class="c1">## gamma(a, loc, scale)  with a an integer is the Erlang distribution</span>
<span class="c1">## gamma(1, loc, scale)  is the Exponential distribution</span>
<span class="c1">## gamma(df/2, 0, 2) is the chi2 distribution with df degrees of freedom.</span>

<span class="k">class</span> <span class="nc">gamma_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A gamma continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    erlang, expon</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gamma` is::</span>

<span class="sd">        gamma.pdf(x, a) = x**(a-1) * exp(-x) / gamma(a)</span>

<span class="sd">    for ``x &gt;= 0``, ``a &gt; 0``. Here ``gamma(a)`` refers to the gamma function.</span>

<span class="sd">    `gamma` has a shape parameter `a` which needs to be set explicitly.</span>

<span class="sd">    When ``a`` is an integer, `gamma` reduces to the Erlang</span>
<span class="sd">    distribution, and when ``a=1`` to the exponential distribution.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_gamma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">gamln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mf">6.0</span><span class="o">/</span><span class="n">a</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="n">gamln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fitstart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># The skewness of the gamma distribution is `4 / sqrt(a)`.</span>
        <span class="c1"># We invert that to estimate the shape `a` using the skewness</span>
        <span class="c1"># of the data.  The formula is regularized with 1e-8 in the</span>
        <span class="c1"># denominator to allow for degenerate data where the skewness</span>
        <span class="c1"># is close to 0.</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1e-8</span> <span class="o">+</span> <span class="n">_skew</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">gamma_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_fitstart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,))</span>

    <span class="nd">@inherit_docstring_from</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="n">f0</span> <span class="o">=</span> <span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fa&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span>
              <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">floc</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;floc&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">fscale</span> <span class="o">=</span> <span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fscale&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">floc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># loc is not fixed.  Use the default fit method.</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">gamma_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="c1"># Special case: loc is fixed.</span>

        <span class="k">if</span> <span class="n">f0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">fscale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># This check is for consistency with `rv_continuous.fit`.</span>
            <span class="c1"># Without this check, this function would just return the</span>
            <span class="c1"># parameters that were given.</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All parameters fixed. There is nothing to &quot;</span>
                             <span class="s2">&quot;optimize.&quot;</span><span class="p">)</span>

        <span class="c1"># Fixed location is handled by shifting the data.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">floc</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">FitDataError</span><span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">floc</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">floc</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Don&#39;t do the subtraction in-place, because `data` might be a</span>
            <span class="c1"># view of the input array.</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="n">floc</span>
        <span class="n">xbar</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="c1"># Three cases to handle:</span>
        <span class="c1"># * shape and scale both free</span>
        <span class="c1"># * shape fixed, scale free</span>
        <span class="c1"># * shape free, scale fixed</span>

        <span class="k">if</span> <span class="n">fscale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># scale is free</span>
            <span class="k">if</span> <span class="n">f0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># shape is fixed</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">f0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># shape and scale are both free.</span>
                <span class="c1"># The MLE for the shape parameter `a` is the solution to:</span>
                <span class="c1"># log(a) - special.digamma(a) - log(xbar) + log(data.mean) = 0</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">xbar</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">digamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
                <span class="n">aest</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="n">s</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">s</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="n">s</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
                <span class="n">xa</span> <span class="o">=</span> <span class="n">aest</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.4</span><span class="p">)</span>
                <span class="n">xb</span> <span class="o">=</span> <span class="n">aest</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.4</span><span class="p">)</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># The MLE for the scale parameter is just the data mean</span>
            <span class="c1"># divided by the shape parameter.</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xbar</span> <span class="o">/</span> <span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># scale is fixed, shape is free</span>
            <span class="c1"># The MLE for the shape parameter `a` is the solution to:</span>
            <span class="c1"># special.digamma(a) - log(data).mean() + log(fscale) = 0</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">fscale</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">_digammainv</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">fscale</span>

        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">floc</span><span class="p">,</span> <span class="n">scale</span>

<span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">erlang_gen</span><span class="p">(</span><span class="n">gamma_gen</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An Erlang continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gamma</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Erlang distribution is a special case of the Gamma distribution, with</span>
<span class="sd">    the shape parameter `a` an integer.  Note that this restriction is not</span>
<span class="sd">    enforced by `erlang`. It will, however, generate a warning the first time</span>
<span class="sd">    a non-integer value is used for the shape parameter.</span>

<span class="sd">    Refer to `gamma` for examples.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">allint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">allpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">allint</span><span class="p">:</span>
            <span class="c1"># An Erlang distribution shouldn&#39;t really have a non-integer</span>
            <span class="c1"># shape parameter, so warn the user.</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;The shape parameter of the erlang distribution &#39;</span>
                <span class="s1">&#39;has been given a non-integer value </span><span class="si">%r</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,),</span>
                <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">allpos</span>

    <span class="k">def</span> <span class="nf">_fitstart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># Override gamma_gen_fitstart so that an integer initial value is</span>
        <span class="c1"># used.  (Also regularize the division, to avoid issues when</span>
        <span class="c1"># _skew(data) is 0 or close to 0.)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1e-8</span> <span class="o">+</span> <span class="n">_skew</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">gamma_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_fitstart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,))</span>

    <span class="c1"># Trivial override of the fit method, so we can monkey-patch its</span>
    <span class="c1"># docstring.</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">erlang_gen</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fit</span><span class="o">.</span><span class="n">__doc__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fit</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="p">(</span><span class="n">rv_continuous</span><span class="o">.</span><span class="n">fit</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">+</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Notes</span>
<span class="sd">            -----</span>
<span class="sd">            The Erlang distribution is generally defined to have integer values</span>
<span class="sd">            for the shape parameter.  This is not enforced by the `erlang` class.</span>
<span class="sd">            When fitting the distribution, it will generally return a non-integer</span>
<span class="sd">            value for the shape parameter.  By using the keyword argument</span>
<span class="sd">            `f0=&lt;integer&gt;`, the fit method can be constrained to fit the data to</span>
<span class="sd">            a specific integer shape parameter.</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">erlang</span> <span class="o">=</span> <span class="n">erlang_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;erlang&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gengamma_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized gamma continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gengamma` is::</span>

<span class="sd">        gengamma.pdf(x, a, c) = abs(c) * x**(c*a-1) * exp(-x**c) / gamma(a)</span>

<span class="sd">    for ``x &gt; 0``, ``a &gt; 0``, and ``c != 0``.</span>

<span class="sd">    `gengamma` takes ``a`` and ``c`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span>
        <span class="n">val1</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
        <span class="n">val2</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span>
        <span class="n">val1</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
        <span class="n">val2</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">val1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">val1</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">val2</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainccinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">val1</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">val2</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainccinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">val1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="c1"># Pochhammer symbol: poch(a,n) = gamma(a+n)/gamma(a)</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">poch</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">val</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="n">val</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="n">gengamma</span> <span class="o">=</span> <span class="n">gengamma_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gengamma&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">genhalflogistic_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized half-logistic continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `genhalflogistic` is::</span>

<span class="sd">        genhalflogistic.pdf(x, c) = 2 * (1-c*x)**(1/c-1) / (1+(1-c*x)**(1/c))**2</span>

<span class="sd">    for ``0 &lt;= x &lt;= 1/c``, and ``c &gt; 0``.</span>

<span class="sd">    `genhalflogistic` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">tmp0</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">**</span><span class="p">(</span><span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tmp2</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">tmp</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">tmp0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">tmp2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">tmp2</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">**</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">tmp2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">tmp2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">((</span><span class="mf">1.0</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">q</span><span class="p">))</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">genhalflogistic</span> <span class="o">=</span> <span class="n">genhalflogistic_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;genhalflogistic&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gompertz_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Gompertz (or truncated Gumbel) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gompertz` is::</span>

<span class="sd">        gompertz.pdf(x, c) = c * exp(x) * exp(-c*(exp(x)-1))</span>

<span class="sd">    for ``x &gt;= 0``, ``c &gt; 0``.</span>

<span class="sd">    `gompertz` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">expn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">gompertz</span> <span class="o">=</span> <span class="n">gompertz_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gompertz&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gumbel_r_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A right-skewed Gumbel continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gumbel_l, gompertz, genextreme</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gumbel_r` is::</span>

<span class="sd">        gumbel_r.pdf(x) = exp(-(x + exp(-x)))</span>

<span class="sd">    The Gumbel distribution is sometimes referred to as a type I Fisher-Tippett</span>
<span class="sd">    distribution.  It is also related to the extreme value distribution,</span>
<span class="sd">    log-Weibull and Gompertz distributions.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_EULER</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">6.0</span><span class="p">,</span> <span class="mi">12</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">_ZETA3</span><span class="p">,</span> <span class="mf">12.0</span><span class="o">/</span><span class="mi">5</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># http://en.wikipedia.org/wiki/Gumbel_distribution</span>
        <span class="k">return</span> <span class="n">_EULER</span> <span class="o">+</span> <span class="mf">1.</span>
<span class="n">gumbel_r</span> <span class="o">=</span> <span class="n">gumbel_r_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gumbel_r&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gumbel_l_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A left-skewed Gumbel continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gumbel_r, gompertz, genextreme</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gumbel_l` is::</span>

<span class="sd">        gumbel_l.pdf(x) = exp(x - exp(x))</span>

<span class="sd">    The Gumbel distribution is sometimes referred to as a type I Fisher-Tippett</span>
<span class="sd">    distribution.  It is also related to the extreme value distribution,</span>
<span class="sd">    log-Weibull and Gompertz distributions.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_EULER</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">6.0</span><span class="p">,</span> \
               <span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">_ZETA3</span><span class="p">,</span> <span class="mf">12.0</span><span class="o">/</span><span class="mi">5</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_EULER</span> <span class="o">+</span> <span class="mf">1.</span>
<span class="n">gumbel_l</span> <span class="o">=</span> <span class="n">gumbel_l_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gumbel_l&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">halfcauchy_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Half-Cauchy continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `halfcauchy` is::</span>

<span class="sd">        halfcauchy.pdf(x) = 2 / (pi * (1 + x**2))</span>

<span class="sd">    for ``x &gt;= 0``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
<span class="n">halfcauchy</span> <span class="o">=</span> <span class="n">halfcauchy_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;halfcauchy&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">halflogistic_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A half-logistic continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `halflogistic` is::</span>

<span class="sd">        halflogistic.pdf(x) = 2 * exp(-x) / (1+exp(-x))**2 = 1/2 * sech(x/2)**2</span>

<span class="sd">    for ``x &gt;= 0``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">arctanh</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.0</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">9</span><span class="o">*</span><span class="n">_ZETA3</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="mf">15.0</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">))</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">halflogistic</span> <span class="o">=</span> <span class="n">halflogistic_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;halflogistic&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">halfnorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A half-normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `halfnorm` is::</span>

<span class="sd">        halfnorm.pdf(x) = sqrt(2/pi) * exp(-x**2/2)</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `halfnorm` is a special case of `chi` with ``df == 1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">2.0</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.0</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ndtri</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span>
<span class="n">halfnorm</span> <span class="o">=</span> <span class="n">halfnorm_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;halfnorm&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">hypsecant_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A hyperbolic secant continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `hypsecant` is::</span>

<span class="sd">        hypsecant.pdf(x) = 1/pi * sech(x)</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">q</span><span class="o">/</span><span class="mf">2.0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
<span class="n">hypsecant</span> <span class="o">=</span> <span class="n">hypsecant_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;hypsecant&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gausshyper_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Gauss hypergeometric continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gausshyper` is::</span>

<span class="sd">        gausshyper.pdf(x, a, b, c, z) =</span>
<span class="sd">            C * x**(a-1) * (1-x)**(b-1) * (1+z*x)**(-c)</span>

<span class="sd">    for ``0 &lt;= x &lt;= 1``, ``a &gt; 0``, ``b &gt; 0``, and</span>
<span class="sd">    ``C = 1 / (B(a, b) F[2, 1](c, a; a+b; -z))``</span>

<span class="sd">    `gausshyper` takes ``a``, ``b``, ``c`` and ``z`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">==</span> <span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">Cinv</span> <span class="o">=</span> <span class="n">gam</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">gam</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">gam</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">hyp2f1</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">Cinv</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">c</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">hyp2f1</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="n">z</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">hyp2f1</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fac</span><span class="o">*</span><span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
<span class="n">gausshyper</span> <span class="o">=</span> <span class="n">gausshyper_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gausshyper&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">invgamma_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An inverted gamma continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `invgamma` is::</span>

<span class="sd">        invgamma.pdf(x, a) = x**(-a-1) / gamma(a) * exp(-1/x)</span>

<span class="sd">    for x &gt; 0, a &gt; 0.</span>

<span class="sd">    `invgamma` takes ``a`` as a shape parameter.</span>

<span class="sd">    `invgamma` is a special case of `gengamma` with ``c == -1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">gamln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">1.</span><span class="o">-</span><span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">):</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

        <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span>
                <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,),</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;k&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span>
                <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,),</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">6.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">11.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">4.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">gamln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">invgamma</span> <span class="o">=</span> <span class="n">invgamma_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;invgamma&#39;</span><span class="p">)</span>


<span class="c1"># scale is gamma from DATAPLOT and B from Regress</span>
<span class="k">class</span> <span class="nc">invgauss_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An inverse Gaussian continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `invgauss` is::</span>

<span class="sd">        invgauss.pdf(x, mu) = 1 / sqrt(2*pi*x**3) * exp(-(x-mu)**2/(2*x*mu**2))</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `invgauss` takes ``mu`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    When `mu` is too small, evaluating the cumulative density function will be</span>
<span class="sd">    inaccurate due to ``cdf(mu -&gt; 0) = inf * 0``.</span>
<span class="sd">    NaNs are returned for ``mu &lt;= 0.0028``.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">wald</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># Numerical accuracy for small `mu` is bad.  See #869.</span>
        <span class="n">C1</span> <span class="o">=</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span>
        <span class="n">C1</span> <span class="o">+=</span> <span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">C1</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="o">**</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="mi">15</span><span class="o">*</span><span class="n">mu</span>
<span class="n">invgauss</span> <span class="o">=</span> <span class="n">invgauss_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;invgauss&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">invweibull_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An inverted Weibull continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `invweibull` is::</span>

<span class="sd">        invweibull.pdf(x, c) = c * x**(-c-1) * exp(-x**(-c))</span>

<span class="sd">    for ``x &gt; 0``, ``c &gt; 0``.</span>

<span class="sd">    `invweibull` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    F.R.S. de Gusmao, E.M.M Ortega and G.M. Cordeiro, &quot;The generalized inverse</span>
<span class="sd">    Weibull distribution&quot;, Stat. Papers, vol. 52, pp. 591-619, 2011.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">xc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">xc2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="n">xc2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">xc2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">xc1</span> <span class="o">*</span> <span class="n">xc2</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">xc1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">xc1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">n</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="n">_EULER</span> <span class="o">+</span> <span class="n">_EULER</span> <span class="o">/</span> <span class="n">c</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">invweibull</span> <span class="o">=</span> <span class="n">invweibull_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;invweibull&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">johnsonsb_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Johnson SB continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    johnsonsu</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `johnsonsb` is::</span>

<span class="sd">        johnsonsb.pdf(x, a, b) = b / (x*(1-x)) * phi(a + b * log(x/(1-x)))</span>

<span class="sd">    for ``0 &lt; x &lt; 1`` and ``a, b &gt; 0``, and ``phi`` is the normal pdf.</span>

<span class="sd">    `johnsonsb` takes ``a`` and ``b`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">trm</span> <span class="o">=</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">trm</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="p">)))</span>
<span class="n">johnsonsb</span> <span class="o">=</span> <span class="n">johnsonsb_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;johnsonsb&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">johnsonsu_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Johnson SU continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    johnsonsb</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `johnsonsu` is::</span>

<span class="sd">        johnsonsu.pdf(x, a, b) = b / sqrt(x**2 + 1) *</span>
<span class="sd">                                 phi(a + b * log(x + sqrt(x**2 + 1)))</span>

<span class="sd">    for all ``x, a, b &gt; 0``, and `phi` is the normal pdf.</span>

<span class="sd">    `johnsonsu` takes ``a`` and ``b`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
        <span class="n">trm</span> <span class="o">=</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">trm</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sinh</span><span class="p">((</span><span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
<span class="n">johnsonsu</span> <span class="o">=</span> <span class="n">johnsonsu_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;johnsonsu&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">laplace_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Laplace continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `laplace` is::</span>

<span class="sd">        laplace.pdf(x) = 1/2 * exp(-abs(x))</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)),</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="n">laplace</span> <span class="o">=</span> <span class="n">laplace_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;laplace&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">levy_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Levy continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    levy_stable, levy_l</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `levy` is::</span>

<span class="sd">        levy.pdf(x) = 1 / (x * sqrt(2*pi*x)) * exp(-1/(2*x))</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    This is the same as the Levy-stable distribution with a=1/2 and b=1.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># Equivalent to 2*norm.sf(sqrt(1/x))</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="c1"># Equivalent to 1.0/(norm.isf(q/2)**2) or 0.5/(erfcinv(q)**2)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">ndtri</span><span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">val</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span>
<span class="n">levy</span> <span class="o">=</span> <span class="n">levy_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;levy&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">levy_l_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A left-skewed Levy continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    levy, levy_stable</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `levy_l` is::</span>

<span class="sd">        levy_l.pdf(x) = 1 / (abs(x) * sqrt(2*pi*abs(x))) * exp(-1/(2*abs(x)))</span>

<span class="sd">    for ``x &lt; 0``.</span>

<span class="sd">    This is the same as the Levy-stable distribution with a=1/2 and b=-1.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">ax</span><span class="p">)</span><span class="o">/</span><span class="n">ax</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ax</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">_norm_ppf</span><span class="p">((</span><span class="n">q</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">val</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inf</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span>
<span class="n">levy_l</span> <span class="o">=</span> <span class="n">levy_l_gen</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;levy_l&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">levy_stable_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Levy-stable continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    levy, levy_l</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Levy-stable distribution (only random variates available -- ignore other</span>
<span class="sd">    docs)</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
        <span class="n">TH</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">)</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">beta</span><span class="o">*</span><span class="n">TH</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">TH</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">W</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">TH</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">beta</span><span class="o">*</span><span class="n">TH</span><span class="p">))</span>

        <span class="n">ialpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">alpha</span>
        <span class="n">aTH</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">TH</span>
        <span class="k">if</span> <span class="n">beta</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">W</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">TH</span><span class="p">)</span><span class="o">/</span><span class="n">tan</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">TH</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">TH</span><span class="p">))</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">**</span><span class="n">ialpha</span>

        <span class="n">val0</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">th0</span> <span class="o">=</span> <span class="n">arctan</span><span class="p">(</span><span class="n">val0</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
        <span class="n">val3</span> <span class="o">=</span> <span class="n">W</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">TH</span><span class="p">)</span><span class="o">/</span><span class="n">tan</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">th0</span><span class="o">+</span><span class="n">TH</span><span class="p">))</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">TH</span><span class="p">))</span>
        <span class="n">res3</span> <span class="o">=</span> <span class="n">val3</span><span class="o">*</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">TH</span><span class="p">)</span><span class="o">-</span><span class="n">val0</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">aTH</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">TH</span><span class="p">)))</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">**</span><span class="n">ialpha</span>
        <span class="k">return</span> <span class="n">res3</span>

    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">beta</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">beta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">beta</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">beta</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<span class="n">levy_stable</span> <span class="o">=</span> <span class="n">levy_stable_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;levy_stable&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">logistic_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A logistic (or Sech-squared) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `logistic` is::</span>

<span class="sd">        logistic.pdf(x) = exp(-x) / (1+exp(-x))**2</span>

<span class="sd">    `logistic` is a special case of `genlogistic` with ``c == 1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">logistic</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">expit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">6.0</span><span class="o">/</span><span class="mf">5.0</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># http://en.wikipedia.org/wiki/Logistic_distribution</span>
        <span class="k">return</span> <span class="mf">2.0</span>
<span class="n">logistic</span> <span class="o">=</span> <span class="n">logistic_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">loggamma_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A log gamma continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `loggamma` is::</span>

<span class="sd">        loggamma.pdf(x, c) = exp(c*x-exp(x)) / gamma(c)</span>

<span class="sd">    for all ``x, c &gt; 0``.</span>

<span class="sd">    `loggamma` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">gamln</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="c1"># See, for example, &quot;A Statistical Study of Log-Gamma Distribution&quot;, by</span>
        <span class="c1"># Ping Shing Chan (thesis, McMaster University, 1993).</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">digamma</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">polygamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">skewness</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">polygamma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">excess_kurtosis</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">polygamma</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">var</span><span class="o">*</span><span class="n">var</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">skewness</span><span class="p">,</span> <span class="n">excess_kurtosis</span>

<span class="n">loggamma</span> <span class="o">=</span> <span class="n">loggamma_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;loggamma&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">loglaplace_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A log-Laplace continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `loglaplace` is::</span>

<span class="sd">        loglaplace.pdf(x, c) = c / 2 * x**(c-1),   for 0 &lt; x &lt; 1</span>
<span class="sd">                             = c / 2 * x**(-c-1),  for x &gt;= 1</span>

<span class="sd">    for ``c &gt; 0``.</span>

<span class="sd">    `loglaplace` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    T.J. Kozubowski and K. Podgorski, &quot;A log-Laplace growth rate model&quot;,</span>
<span class="sd">    The Mathematical Scientist, vol. 28, pp. 49-60, 2003.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">cd2</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cd2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">q</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="n">loglaplace</span> <span class="o">=</span> <span class="n">loglaplace_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;loglaplace&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_lognorm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span>
                      <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)),</span>
                      <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">lognorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A lognormal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `lognorm` is::</span>

<span class="sd">        lognorm.pdf(x, s) = 1 / (s*x*sqrt(2*pi)) * exp(-1/2*(log(x)/s)**2)</span>

<span class="sd">    for ``x &gt; 0``, ``s &gt; 0``.</span>

<span class="sd">    `lognorm` takes ``s`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    A common parametrization for a lognormal random variable ``Y`` is in</span>
<span class="sd">    terms of the mean, ``mu``, and standard deviation, ``sigma``, of the</span>
<span class="sd">    unique normally distributed random variable ``X`` such that exp(X) = Y.</span>
<span class="sd">    This parametrization corresponds to setting ``s = sigma`` and ``scale =</span>
<span class="sd">    exp(mu)``.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_lognorm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">p</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">lognorm</span> <span class="o">=</span> <span class="n">lognorm_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lognorm&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gilbrat_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Gilbrat continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gilbrat` is::</span>

<span class="sd">        gilbrat.pdf(x) = 1/(x*sqrt(2*pi)) * exp(-1/2*(log(x))**2)</span>

<span class="sd">    `gilbrat` is a special case of `lognorm` with ``s = 1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_lognorm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">gilbrat</span> <span class="o">=</span> <span class="n">gilbrat_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gilbrat&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">maxwell_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Maxwell continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    A special case of a `chi` distribution,  with ``df = 3``, ``loc = 0.0``,</span>
<span class="sd">    and given ``scale = a``, where ``a`` is the parameter used in the</span>
<span class="sd">    Mathworld description [1]_.</span>

<span class="sd">    The probability density function for `maxwell` is::</span>

<span class="sd">        maxwell.pdf(x) = sqrt(2/pi)x**2 * exp(-x**2/2)</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] http://mathworld.wolfram.com/MaxwellDistribution.html</span>

<span class="sd">    %(example)s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">chi</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">-</span><span class="mi">8</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="p">),</span> <span class="mi">3</span><span class="o">-</span><span class="mi">8</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">val</span><span class="o">**</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span> <span class="o">+</span> <span class="mi">160</span><span class="o">*</span><span class="n">pi</span> <span class="o">-</span> <span class="mi">384</span><span class="p">)</span> <span class="o">/</span> <span class="n">val</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_EULER</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span>
<span class="n">maxwell</span> <span class="o">=</span> <span class="n">maxwell_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;maxwell&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">mielke_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Mielke&#39;s Beta-Kappa continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `mielke` is::</span>

<span class="sd">        mielke.pdf(x, k, s) = k * x**(k-1) / (1+x**s)**(1+k/s)</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `mielke` takes ``k`` and ``s`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">qsk</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">qsk</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">qsk</span><span class="p">),</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<span class="n">mielke</span> <span class="o">=</span> <span class="n">mielke_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mielke&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">nakagami_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Nakagami continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `nakagami` is::</span>

<span class="sd">        nakagami.pdf(x, nu) = 2 * nu**nu / gamma(nu) *</span>
<span class="sd">                              x**(2*nu-1) * exp(-nu*x**2)</span>

<span class="sd">    for ``x &gt; 0``, ``nu &gt; 0``.</span>

<span class="sd">    `nakagami` takes ``nu`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="o">**</span><span class="n">nu</span><span class="o">/</span><span class="n">gam</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">nu</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">nu</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">gam</span><span class="p">(</span><span class="n">nu</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="n">gam</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">mu</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">nu</span><span class="o">*</span><span class="n">mu2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">nu</span> <span class="o">+</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">nu</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">g2</span> <span class="o">/=</span> <span class="n">nu</span><span class="o">*</span><span class="n">mu2</span><span class="o">**</span><span class="mf">2.0</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">nakagami</span> <span class="o">=</span> <span class="n">nakagami_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nakagami&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ncx2_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A non-central chi-squared continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `ncx2` is::</span>

<span class="sd">        ncx2.pdf(x, df, nc) = exp(-(nc+x)/2) * 1/2 * (x/nc)**((df-2)/4)</span>
<span class="sd">                              * I[(df-2)/2](sqrt(nc*x))</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `ncx2` takes ``df`` and ``nc`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">noncentral_chisquare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_ncx2_log_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_ncx2_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_ncx2_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">chndtrix</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">df</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">nc</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">df</span> <span class="o">+</span> <span class="n">nc</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">val</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">val</span><span class="o">+</span><span class="n">nc</span><span class="p">)</span><span class="o">/</span><span class="n">val</span><span class="o">**</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="mf">12.0</span><span class="o">*</span><span class="p">(</span><span class="n">val</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">nc</span><span class="p">)</span><span class="o">/</span><span class="n">val</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ncx2</span> <span class="o">=</span> <span class="n">ncx2_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ncx2&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ncf_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A non-central F distribution continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `ncf` is::</span>

<span class="sd">        ncf.pdf(x, df1, df2, nc) = exp(nc/2 + nc*df1*x/(2*(df1*x+df2))) *</span>
<span class="sd">                    df1**(df1/2) * df2**(df2/2) * x**(df1/2-1) *</span>
<span class="sd">                    (df2+df1*x)**(-(df1+df2)/2) *</span>
<span class="sd">                    gamma(df1/2)*gamma(1+df2/2) *</span>
<span class="sd">                    L^{v1/2-1}^{v2/2}(-nc*v1*x/(2*(v1*x+v2))) /</span>
<span class="sd">                    (B(v1/2, v2/2) * gamma((v1+v2)/2))</span>

<span class="sd">    for ``df1, df2, nc &gt; 0``.</span>

<span class="sd">    `ncf` takes ``df1``, ``df2`` and ``nc`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">noncentral_f</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf_skip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span>
        <span class="n">term</span> <span class="o">=</span> <span class="o">-</span><span class="n">nc</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">nc</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="n">n1</span><span class="o">*</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">gamln</span><span class="p">(</span><span class="n">n1</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="n">gamln</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n2</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">term</span> <span class="o">-=</span> <span class="n">gamln</span><span class="p">((</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">*=</span> <span class="n">n1</span><span class="o">**</span><span class="p">(</span><span class="n">n1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">n2</span><span class="o">**</span><span class="p">(</span><span class="n">n2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">n1</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">*=</span> <span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="n">n1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">*=</span> <span class="n">special</span><span class="o">.</span><span class="n">assoc_laguerre</span><span class="p">(</span><span class="o">-</span><span class="n">nc</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="n">n1</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span> <span class="n">n2</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n1</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">/=</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">n1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># This function does not have a return.  Drop it for now, the generic</span>
        <span class="c1"># function seems to work OK.</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ncfdtr</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">ncfdtri</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">dfn</span> <span class="o">*</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">dfd</span><span class="p">)</span><span class="o">**</span><span class="n">n</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">gamln</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dfn</span><span class="p">)</span> <span class="o">+</span> <span class="n">gamln</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dfd</span><span class="o">-</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">gamln</span><span class="p">(</span><span class="n">dfd</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">*=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">nc</span> <span class="o">/</span> <span class="mf">2.0</span><span class="o">+</span><span class="n">term</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">*=</span> <span class="n">special</span><span class="o">.</span><span class="n">hyp1f1</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dfn</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dfn</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">nc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dfd</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">dfd</span> <span class="o">/</span> <span class="p">(</span><span class="n">dfd</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nc</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">dfn</span><span class="p">))</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dfd</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">dfd</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">dfn</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span>
                    <span class="p">((</span><span class="n">dfn</span><span class="o">+</span><span class="n">nc</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">dfn</span><span class="o">+</span><span class="n">nc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">dfd</span><span class="o">-</span><span class="mf">2.0</span><span class="p">))</span> <span class="o">/</span>
                    <span class="p">((</span><span class="n">dfd</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">dfd</span><span class="o">-</span><span class="mf">4.0</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
<span class="n">ncf</span> <span class="o">=</span> <span class="n">ncf_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ncf&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">t_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Student&#39;s T continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `t` is::</span>

<span class="sd">                                       gamma((df+1)/2)</span>
<span class="sd">        t.pdf(x, df) = ---------------------------------------------------</span>
<span class="sd">                       sqrt(pi*df) * gamma(df/2) * (1+x**2/df)**((df+1)/2)</span>

<span class="sd">    for ``df &gt; 0``.</span>

<span class="sd">    `t` takes ``df`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_t</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">df</span><span class="o">*</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">gamln</span><span class="p">((</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">gamln</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">Px</span> <span class="o">/=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Px</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">df</span><span class="o">*</span><span class="mf">1.0</span>
        <span class="n">lPx</span> <span class="o">=</span> <span class="n">gamln</span><span class="p">((</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">gamln</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">lPx</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">r</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lPx</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">stdtr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">stdtr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">stdtrit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">stdtrit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">df</span><span class="p">,),</span>
                         <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.0</span><span class="p">),</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="n">_lazywhere</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">df</span><span class="p">,),</span>
                        <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">4.0</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">nct_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A non-central Student&#39;s T continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `nct` is::</span>

<span class="sd">                                            df**(df/2) * gamma(df+1)</span>
<span class="sd">        nct.pdf(x, df, nc) = ----------------------------------------------------</span>
<span class="sd">                             2**df*exp(nc**2/2) * (df+x**2)**(df/2) * gamma(df/2)</span>

<span class="sd">    for ``df &gt; 0``.</span>

<span class="sd">    `nct` takes ``df`` and ``nc`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">nc</span> <span class="o">==</span> <span class="n">nc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">sz</span><span class="p">,</span> <span class="n">rndm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rndm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">df</span><span class="o">*</span><span class="mf">1.0</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">nc</span><span class="o">*</span><span class="mf">1.0</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
        <span class="n">ncx2</span> <span class="o">=</span> <span class="n">nc</span><span class="o">*</span><span class="n">nc</span><span class="o">*</span><span class="n">x2</span>
        <span class="n">fac1</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">x2</span>
        <span class="n">trm1</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">gamln</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">trm1</span> <span class="o">-=</span> <span class="n">n</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">nc</span><span class="o">*</span><span class="n">nc</span><span class="o">/</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">fac1</span><span class="p">)</span><span class="o">+</span><span class="n">gamln</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">trm1</span><span class="p">)</span>
        <span class="n">valF</span> <span class="o">=</span> <span class="n">ncx2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">fac1</span><span class="p">)</span>
        <span class="n">trm1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">nc</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">hyp1f1</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">valF</span><span class="p">)</span>
        <span class="n">trm1</span> <span class="o">/=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">fac1</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">trm2</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">hyp1f1</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">valF</span><span class="p">)</span>
        <span class="n">trm2</span> <span class="o">/=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fac1</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">Px</span> <span class="o">*=</span> <span class="n">trm1</span><span class="o">+</span><span class="n">trm2</span>
        <span class="k">return</span> <span class="n">Px</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">nctdtr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">nctdtrit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mv&#39;</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># See D. Hogben, R.S. Pinkham, and M.B. Wilk,</span>
        <span class="c1"># &#39;The moments of the non-central t-distribution&#39;</span>
        <span class="c1"># Biometrika 48, p. 465 (2961).</span>
        <span class="c1"># e.g. http://www.jstor.org/stable/2332772 (gated)</span>
        <span class="c1">#</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

        <span class="n">gfac</span> <span class="o">=</span> <span class="n">gam</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">gam</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">c11</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">*</span> <span class="n">gfac</span>
        <span class="n">c20</span> <span class="o">=</span> <span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">c22</span> <span class="o">=</span> <span class="n">c20</span> <span class="o">-</span> <span class="n">c11</span><span class="o">*</span><span class="n">c11</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="o">*</span><span class="n">c11</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c22</span><span class="o">*</span><span class="n">nc</span><span class="o">*</span><span class="n">nc</span> <span class="o">+</span> <span class="n">c20</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">c33t</span> <span class="o">=</span> <span class="n">df</span> <span class="o">*</span> <span class="p">(</span><span class="mf">7.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">df</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">3.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">c11</span><span class="o">*</span><span class="n">c11</span>
            <span class="n">c31t</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">3.</span><span class="p">)</span>
            <span class="n">mu3</span> <span class="o">=</span> <span class="p">(</span><span class="n">c33t</span><span class="o">*</span><span class="n">nc</span><span class="o">*</span><span class="n">nc</span> <span class="o">+</span> <span class="n">c31t</span><span class="p">)</span> <span class="o">*</span> <span class="n">c11</span><span class="o">*</span><span class="n">nc</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mu3</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="c1">#kurtosis</span>
        <span class="k">if</span> <span class="s1">&#39;k&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">c44</span> <span class="o">=</span> <span class="n">df</span><span class="o">*</span><span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">4.</span><span class="p">)</span>
            <span class="n">c44</span> <span class="o">-=</span> <span class="n">c11</span><span class="o">*</span><span class="n">c11</span> <span class="o">*</span> <span class="mf">2.</span><span class="o">*</span><span class="n">df</span><span class="o">*</span><span class="p">(</span><span class="mf">5.</span><span class="o">-</span><span class="n">df</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">3.</span><span class="p">)</span>
            <span class="n">c44</span> <span class="o">-=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">c11</span><span class="o">**</span><span class="mi">4</span>
            <span class="n">c42</span> <span class="o">=</span> <span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">4.</span><span class="p">)</span> <span class="o">-</span> <span class="n">c11</span><span class="o">*</span><span class="n">c11</span> <span class="o">*</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">3.</span><span class="p">)</span>
            <span class="n">c42</span> <span class="o">*=</span> <span class="mf">6.</span><span class="o">*</span><span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span>
            <span class="n">c40</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">df</span><span class="o">*</span><span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">-</span><span class="mf">4.</span><span class="p">)</span>

            <span class="n">mu4</span> <span class="o">=</span> <span class="n">c44</span> <span class="o">*</span> <span class="n">nc</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">c42</span><span class="o">*</span><span class="n">nc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c40</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mu4</span><span class="o">/</span><span class="n">mu2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<span class="n">nct</span> <span class="o">=</span> <span class="n">nct_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;nct&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">pareto_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Pareto continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `pareto` is::</span>

<span class="sd">        pareto.pdf(x, b) = b / x**(b+1)</span>

<span class="sd">    for ``x &gt;= 1``, ``b &gt; 0``.</span>

<span class="sd">    `pareto` takes ``b`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mv&#39;</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="s1">&#39;m&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="n">bt</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">valarray</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="n">inf</span><span class="p">)</span>
            <span class="n">place</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">bt</span> <span class="o">/</span> <span class="p">(</span><span class="n">bt</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;v&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">2</span>
            <span class="n">bt</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">mu2</span> <span class="o">=</span> <span class="n">valarray</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="n">inf</span><span class="p">)</span>
            <span class="n">place</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">bt</span> <span class="o">/</span> <span class="p">(</span><span class="n">bt</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">bt</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">3</span>
            <span class="n">bt</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">valarray</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">bt</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">bt</span> <span class="o">-</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">bt</span> <span class="o">-</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">bt</span><span class="p">))</span>
            <span class="n">place</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;k&#39;</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">4</span>
            <span class="n">bt</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">valarray</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.0</span><span class="o">*</span><span class="n">polyval</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">bt</span><span class="p">)</span> <span class="o">/</span>
                    <span class="n">polyval</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">bt</span><span class="p">))</span>
            <span class="n">place</span><span class="p">(</span><span class="n">g2</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">c</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pareto&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">lomax_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Lomax (Pareto of the second kind) continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Lomax distribution is a special case of the Pareto distribution, with</span>
<span class="sd">    (loc=-1.0).</span>

<span class="sd">    The probability density function for `lomax` is::</span>

<span class="sd">        lomax.pdf(x, c) = c / (1+x)**(c+1)</span>

<span class="sd">    for ``x &gt;= 0``, ``c &gt; 0``.</span>

<span class="sd">    `lomax` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logsf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">pareto</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">loc</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mf">1.0</span><span class="o">/</span><span class="n">c</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">lomax</span> <span class="o">=</span> <span class="n">lomax_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lomax&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">pearson3_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A pearson type III continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `pearson3` is::</span>

<span class="sd">        pearson3.pdf(x, skew) = abs(beta) / gamma(alpha) *</span>
<span class="sd">            (beta * (x - zeta))**(alpha - 1) * exp(-beta*(x - zeta))</span>

<span class="sd">    where::</span>

<span class="sd">            beta = 2 / (skew * stddev)</span>
<span class="sd">            alpha = (stddev * beta)**2</span>
<span class="sd">            zeta = loc - alpha / beta</span>

<span class="sd">    `pearson3` takes ``skew`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    R.W. Vogel and D.E. McMartin, &quot;Probability Plot Goodness-of-Fit and</span>
<span class="sd">    Skewness Estimation Procedures for the Pearson Type 3 Distribution&quot;, Water</span>
<span class="sd">    Resources Research, Vol.27, 3149-3158 (1991).</span>

<span class="sd">    L.R. Salvosa, &quot;Tables of Pearson&#39;s Type III Function&quot;, Ann. Math. Statist.,</span>
<span class="sd">    Vol.1, 191-198 (1930).</span>

<span class="sd">    &quot;Using Modern Computing Tools to Fit the Pearson Type III Distribution to</span>
<span class="sd">    Aviation Loads Data&quot;, Office of Aviation Research (2003).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="c1"># The real &#39;loc&#39; and &#39;scale&#39; are handled in the calling pdf(...). The</span>
        <span class="c1"># local variables &#39;loc&#39; and &#39;scale&#39; within pearson3._pdf are set to</span>
        <span class="c1"># the defaults just to keep them as part of the equations for</span>
        <span class="c1"># documentation.</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># If skew is small, return _norm_pdf. The divide between pearson3</span>
        <span class="c1"># and norm was found by brute force and is approximately a skew of</span>
        <span class="c1"># 0.000016.  No one, I hope, would actually use a skew value even</span>
        <span class="c1"># close to this small.</span>
        <span class="n">norm2pearson_transition</span> <span class="o">=</span> <span class="mf">0.000016</span>

        <span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">skew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">skew</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">norm2pearson_transition</span>
        <span class="n">invmask</span> <span class="o">=</span> <span class="o">~</span><span class="n">mask</span>

        <span class="n">beta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">skew</span><span class="p">[</span><span class="n">invmask</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">beta</span>

        <span class="n">transx</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">invmask</span><span class="p">]</span> <span class="o">-</span> <span class="n">zeta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transx</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">invmask</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">zeta</span>

    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="c1"># The _argcheck function in rv_continuous only allows positive</span>
        <span class="c1"># arguments.  The skew argument for pearson3 can be zero (which I want</span>
        <span class="c1"># to handle inside pearson3._pdf) or negative.  So just return True</span>
        <span class="c1"># for all skew args.</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">skew</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transx</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">invmask</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">skew</span><span class="p">))</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">zeta</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">beta</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="n">alpha</span>
        <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">k</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="c1"># Do the calculation in _logpdf since helps to limit</span>
        <span class="c1"># overflow/underflow problems</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ans</span><span class="p">):</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">return</span> <span class="n">ans</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ans</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="c1">#   PEARSON3 logpdf                           GAMMA logpdf</span>
        <span class="c1">#   np.log(abs(beta))</span>
        <span class="c1"># + (alpha - 1)*log(beta*(x - zeta))          + (a - 1)*log(x)</span>
        <span class="c1"># - beta*(x - zeta)                           - x</span>
        <span class="c1"># - gamln(alpha)                              - gamln(a)</span>
        <span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transx</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">invmask</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">))</span>

        <span class="n">ans</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">_norm_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">invmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span> <span class="o">+</span> <span class="n">gamma</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">transx</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transx</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">invmask</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">skew</span><span class="p">))</span>

        <span class="n">ans</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">invmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">_cdf</span><span class="p">(</span><span class="n">transx</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="n">ans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transx</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">invmask</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">skew</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_gamma</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span> <span class="o">+</span> <span class="n">zeta</span>
        <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ans</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">skew</span><span class="p">):</span>
        <span class="n">ans</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">transq</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">invmask</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">skew</span><span class="p">))</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">invmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="n">invmask</span><span class="p">])</span><span class="o">/</span><span class="n">beta</span> <span class="o">+</span> <span class="n">zeta</span>
        <span class="k">return</span> <span class="n">ans</span>
<span class="n">pearson3</span> <span class="o">=</span> <span class="n">pearson3_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pearson3&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">powerlaw_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A power-function continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `powerlaw` is::</span>

<span class="sd">        powerlaw.pdf(x, a) = a * x**(a-1)</span>

<span class="sd">    for ``0 &lt;= x &lt;= 1``, ``a &gt; 0``.</span>

<span class="sd">    `powerlaw` takes ``a`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    `powerlaw` is a special case of `beta` with ``b == 1``.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">xlogy</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">))</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span><span class="p">),</span>
                <span class="mi">6</span> <span class="o">*</span> <span class="n">polyval</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">a</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">powerlaw</span> <span class="o">=</span> <span class="n">powerlaw_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;powerlaw&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">powerlognorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A power log-normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `powerlognorm` is::</span>

<span class="sd">        powerlognorm.pdf(x, c, s) = c / (x*s) * phi(log(x)/s) *</span>
<span class="sd">                                                (Phi(-log(x)/s))**(c-1),</span>

<span class="sd">    where ``phi`` is the normal pdf, and ``Phi`` is the normal cdf,</span>
<span class="sd">    and ``x &gt; 0``, ``s, c &gt; 0``.</span>

<span class="sd">    `powerlognorm` takes ``c`` and ``s`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span>
                <span class="nb">pow</span><span class="p">(</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">),</span> <span class="n">c</span><span class="o">*</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">),</span> <span class="n">c</span><span class="o">*</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">_norm_ppf</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">q</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span><span class="p">)))</span>
<span class="n">powerlognorm</span> <span class="o">=</span> <span class="n">powerlognorm_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;powerlognorm&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">powernorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A power normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `powernorm` is::</span>

<span class="sd">        powernorm.pdf(x, c) = c * phi(x) * (Phi(-x))**(c-1)</span>

<span class="sd">    where ``phi`` is the normal pdf, and ``Phi`` is the normal cdf,</span>
<span class="sd">    and ``x &gt; 0``, ``c &gt; 0``.</span>

<span class="sd">    `powernorm` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">_norm_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">_norm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">_norm_logcdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_norm_ppf</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">q</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">c</span><span class="p">))</span>
<span class="n">powernorm</span> <span class="o">=</span> <span class="n">powernorm_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;powernorm&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">rdist_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An R-distributed continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `rdist` is::</span>

<span class="sd">        rdist.pdf(x, c) = (1-x**2)**(c/2-1) / B(1/2, c/2)</span>

<span class="sd">    for ``-1 &lt;= x &lt;= 1``, ``c &gt; 0``.</span>

<span class="sd">    `rdist` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">term1</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">hyp2f1</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># There&#39;s an issue with hyp2f1, it returns nans near x = +-1, c &gt; 100.</span>
        <span class="c1"># Use the generic implementation in that case.  See gh-1285 for</span>
        <span class="c1"># background.</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">res</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">rv_continuous</span><span class="o">.</span><span class="n">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">((</span><span class="n">n</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">special</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
<span class="n">rdist</span> <span class="o">=</span> <span class="n">rdist_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rdist&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">rayleigh_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Rayleigh continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `rayleigh` is::</span>

<span class="sd">        rayleigh.pdf(r) = r * exp(-r**2/2)</span>

<span class="sd">    for ``x &gt;= 0``.</span>

<span class="sd">    `rayleigh` is a special case of `chi` with ``df == 2``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">chi</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">pi</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">val</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">val</span><span class="o">**</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="mi">6</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">val</span><span class="o">-</span><span class="mi">16</span><span class="o">/</span><span class="n">val</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_EULER</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rayleigh</span> <span class="o">=</span> <span class="n">rayleigh_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rayleigh&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">reciprocal_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A reciprocal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `reciprocal` is::</span>

<span class="sd">        reciprocal.pdf(x, a, b) = 1 / (x*log(b/a))</span>

<span class="sd">    for ``a &lt;= x &lt;= b``, ``a, b &gt; 0``.</span>

<span class="sd">    `reciprocal` takes ``a`` and ``b`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">a</span><span class="p">))</span>
<span class="n">reciprocal</span> <span class="o">=</span> <span class="n">reciprocal_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;reciprocal&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">rice_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Rice continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `rice` is::</span>

<span class="sd">        rice.pdf(x, b) = x * exp(-(x**2+b**2)/2) * I[0](x*b)</span>

<span class="sd">    for ``x &gt; 0``, ``b &gt; 0``.</span>

<span class="sd">    `rice` takes ``b`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    The Rice distribution describes the length, ``r``, of a 2-D vector</span>
<span class="sd">    with components ``(U+u, V+v)``, where ``U, V`` are constant, ``u, v``</span>
<span class="sd">    are independent Gaussian random variables with standard deviation</span>
<span class="sd">    ``s``.  Let ``R = (U**2 + V**2)**0.5``. Then the pdf of ``r`` is</span>
<span class="sd">    ``rice.pdf(x, R/s, scale=s)``.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">b</span> <span class="o">&gt;=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># http://en.wikipedia.org/wiki/Rice_distribution</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">b</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sz</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">chndtr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chndtrix</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># We use (x**2 + b**2)/2 = ((x-b)**2)/2 + xb.</span>
        <span class="c1"># The factor of exp(-xb) is then included in the i0e function</span>
        <span class="c1"># in place of the modified Bessel function, i0, improving</span>
        <span class="c1"># numerical stability for large values of xb.</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">i0e</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">nd2</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">nd2</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">**</span><span class="p">(</span><span class="n">nd2</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b2</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">*</span>
                <span class="n">special</span><span class="o">.</span><span class="n">hyp1f1</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b2</span><span class="p">))</span>
<span class="n">rice</span> <span class="o">=</span> <span class="n">rice_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rice&quot;</span><span class="p">)</span>


<span class="c1"># FIXME: PPF does not work.</span>
<span class="k">class</span> <span class="nc">recipinvgauss_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A reciprocal inverse Gaussian continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `recipinvgauss` is::</span>

<span class="sd">        recipinvgauss.pdf(x, mu) = 1/sqrt(2*pi*x) * exp(-(1-mu*x)**2/(2*x*mu**2))</span>

<span class="sd">    for ``x &gt;= 0``.</span>

<span class="sd">    `recipinvgauss` takes ``mu`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">wald</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">mu</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="n">trm1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">mu</span> <span class="o">-</span> <span class="n">x</span>
        <span class="n">trm2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">mu</span> <span class="o">+</span> <span class="n">x</span>
        <span class="n">isqx</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="n">isqx</span><span class="o">*</span><span class="n">trm1</span><span class="p">)</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">isqx</span><span class="o">*</span><span class="n">trm2</span><span class="p">)</span>
<span class="n">recipinvgauss</span> <span class="o">=</span> <span class="n">recipinvgauss_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;recipinvgauss&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">semicircular_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A semicircular continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `semicircular` is::</span>

<span class="sd">        semicircular.pdf(x) = 2/pi * sqrt(1-x**2)</span>

<span class="sd">    for ``-1 &lt;= x &lt;= 1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">+</span><span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">arcsin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.64472988584940017414</span>
<span class="n">semicircular</span> <span class="o">=</span> <span class="n">semicircular_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;semicircular&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">triang_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A triangular continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The triangular distribution can be represented with an up-sloping line from</span>
<span class="sd">    ``loc`` to ``(loc + c*scale)`` and then downsloping for ``(loc + c*scale)``</span>
<span class="sd">    to ``(loc+scale)``.</span>

<span class="sd">    `triang` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    The standard form is in the range [0, 1] with c the mode.</span>
<span class="sd">    The location parameter shifts the start to `loc`.</span>
<span class="sd">    The scale parameter changes the width from 1 to `scale`.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">triangular</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">c</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">q</span><span class="p">),</span> <span class="mi">1</span><span class="o">-</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="mi">18</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> \
               <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="mf">1.0</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">)),</span> <span class="o">-</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">5.0</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">triang</span> <span class="o">=</span> <span class="n">triang_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;triang&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">truncexpon_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A truncated exponential continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `truncexpon` is::</span>

<span class="sd">        truncexpon.pdf(x, b) = exp(-x) / (1-exp(-b))</span>

<span class="sd">    for ``0 &lt; x &lt; b``.</span>

<span class="sd">    `truncexpon` takes ``b`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_munp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># wrong answer with formula, same as in continuous.pdf</span>
        <span class="c1"># return gam(n+1)-special.gammainc(1+n, b)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># return generic for higher moments</span>
            <span class="c1"># return rv_continuous._mom1_sc(self, n, b)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mom1_sc</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">eB</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">eB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eB</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">eB</span><span class="p">)</span>
<span class="n">truncexpon</span> <span class="o">=</span> <span class="n">truncexpon_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;truncexpon&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">truncnorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A truncated normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The standard form of this distribution is a standard normal truncated to</span>
<span class="sd">    the range [a, b] --- notice that a and b are defined over the domain of the</span>
<span class="sd">    standard normal.  To convert clip values for a specific mean and standard</span>
<span class="sd">    deviation, use::</span>

<span class="sd">        a, b = (myclip_a - my_mean) / my_std, (myclip_b - my_mean) / my_std</span>

<span class="sd">    `truncnorm` takes ``a`` and ``b`` as shape parameters.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nb</span> <span class="o">=</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_na</span> <span class="o">=</span> <span class="n">_norm_cdf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sb</span> <span class="o">=</span> <span class="n">_norm_sf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sa</span> <span class="o">=</span> <span class="n">_norm_sf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sb</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sa</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nb</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_na</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logdelta</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delta</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_norm_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logdelta</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">_norm_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_na</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_norm_isf</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_sb</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sa</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_norm_ppf</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_nb</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_na</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">nA</span><span class="p">,</span> <span class="n">nB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_na</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nb</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nB</span> <span class="o">-</span> <span class="n">nA</span>
        <span class="n">pA</span><span class="p">,</span> <span class="n">pB</span> <span class="o">=</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">_norm_pdf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">pA</span> <span class="o">-</span> <span class="n">pB</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span>   <span class="c1"># correction sign</span>
        <span class="n">mu2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">pA</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">pB</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">mu</span>
        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
<span class="n">truncnorm</span> <span class="o">=</span> <span class="n">truncnorm_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;truncnorm&#39;</span><span class="p">)</span>


<span class="c1"># FIXME: RVS does not work.</span>
<span class="k">class</span> <span class="nc">tukeylambda_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Tukey-Lamdba continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    A flexible distribution, able to represent and interpolate between the</span>
<span class="sd">    following distributions:</span>

<span class="sd">        - Cauchy                (lam=-1)</span>
<span class="sd">        - logistic              (lam=0.0)</span>
<span class="sd">        - approx Normal         (lam=0.14)</span>
<span class="sd">        - u-shape               (lam = 0.5)</span>
<span class="sd">        - uniform from -1 to 1  (lam = 1)</span>

<span class="sd">    `tukeylambda` takes ``lam`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">lam</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="n">Fx</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">tklmbda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lam</span><span class="p">))</span>
        <span class="n">Px</span> <span class="o">=</span> <span class="n">Fx</span><span class="o">**</span><span class="p">(</span><span class="n">lam</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Fx</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">lam</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">Px</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">asarray</span><span class="p">(</span><span class="n">Px</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">((</span><span class="n">lam</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">asarray</span><span class="p">(</span><span class="n">lam</span><span class="p">)),</span> <span class="n">Px</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">tklmbda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">boxcox</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">boxcox1p</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_tlvar</span><span class="p">(</span><span class="n">lam</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_tlkurt</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">integ</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lam</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">lam</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tukeylambda</span> <span class="o">=</span> <span class="n">tukeylambda_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;tukeylambda&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">uniform_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A uniform continuous random variable.</span>

<span class="sd">    This distribution is constant between `loc` and ``loc + scale``.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">q</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span>
<span class="n">uniform</span> <span class="o">=</span> <span class="n">uniform_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">vonmises_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Von Mises continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If `x` is not in range or `loc` is not in range it assumes they are angles</span>
<span class="sd">    and converts them to [-pi, pi] equivalents.</span>

<span class="sd">    The probability density function for `vonmises` is::</span>

<span class="sd">        vonmises.pdf(x, kappa) = exp(kappa * cos(x)) / (2*pi*I[0](kappa))</span>

<span class="sd">    for ``-pi &lt;= x &lt;= pi``, ``kappa &gt; 0``.</span>

<span class="sd">    `vonmises` takes ``kappa`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    vonmises_line : The same distribution, defined on a [-pi, pi] segment</span>
<span class="sd">                    of the real line.</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kappa</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">vonmises</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">kappa</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">kappa</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">special</span><span class="o">.</span><span class="n">i0</span><span class="p">(</span><span class="n">kappa</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">kappa</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">vonmises_cython</span><span class="o">.</span><span class="n">von_mises_cdf</span><span class="p">(</span><span class="n">kappa</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats_skip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kappa</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span>
<span class="n">vonmises</span> <span class="o">=</span> <span class="n">vonmises_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;vonmises&#39;</span><span class="p">)</span>
<span class="n">vonmises_line</span> <span class="o">=</span> <span class="n">vonmises_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vonmises_line&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">wald_gen</span><span class="p">(</span><span class="n">invgauss_gen</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Wald continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `wald` is::</span>

<span class="sd">        wald.pdf(x) = 1/sqrt(2*pi*x**3) * exp(-(x-1)**2/(2*x))</span>

<span class="sd">    for ``x &gt; 0``.</span>

<span class="sd">    `wald` is a special case of `invgauss` with ``mu == 1``.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">wald</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">invgauss</span><span class="o">.</span><span class="n">_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">invgauss</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">invgauss</span><span class="o">.</span><span class="n">_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">15.0</span>
<span class="n">wald</span> <span class="o">=</span> <span class="n">wald_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wald&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">wrapcauchy_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A wrapped Cauchy continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `wrapcauchy` is::</span>

<span class="sd">        wrapcauchy.pdf(x, c) = (1-c**2) / (2*pi*(1+c**2-2*c*cos(x)))</span>

<span class="sd">    for ``0 &lt;= x &lt;= 2*pi``, ``0 &lt; c &lt; 1``.</span>

<span class="sd">    `wrapcauchy` takes ``c`` as a shape parameter.</span>

<span class="sd">    %(after_notes)s</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_argcheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">c</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">pi</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">c1</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">xn</span><span class="p">)):</span>
            <span class="n">valn</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">val</span><span class="p">)</span>
            <span class="n">xn</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span> <span class="o">-</span> <span class="n">xn</span>
            <span class="n">yn</span> <span class="o">=</span> <span class="n">tan</span><span class="p">(</span><span class="n">xn</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="n">on</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">valn</span><span class="o">*</span><span class="n">yn</span><span class="p">)</span>
            <span class="n">place</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">on</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">xp</span><span class="p">)):</span>
            <span class="n">valp</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">val</span><span class="p">)</span>
            <span class="n">yp</span> <span class="o">=</span> <span class="n">tan</span><span class="p">(</span><span class="n">xp</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="n">op</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pi</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">valp</span><span class="o">*</span><span class="n">yp</span><span class="p">)</span>
            <span class="n">place</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">c</span><span class="p">)</span>
        <span class="n">rcq</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">val</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">q</span><span class="p">))</span>
        <span class="n">rcmq</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">arctan</span><span class="p">(</span><span class="n">val</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">rcq</span><span class="p">,</span> <span class="n">rcmq</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>
<span class="n">wrapcauchy</span> <span class="o">=</span> <span class="n">wrapcauchy_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;wrapcauchy&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">gennorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generalized normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `gennorm` is [1]_::</span>

<span class="sd">                                     beta</span>
<span class="sd">        gennorm.pdf(x, beta) =  ---------------  exp(-|x|**beta)</span>
<span class="sd">                                2 gamma(1/beta)</span>

<span class="sd">    `gennorm` takes ``beta`` as a shape parameter.</span>
<span class="sd">    For ``beta = 1``, it is identical to a Laplace distribution.</span>
<span class="sd">    For ``beta = 2``, it is identical to a normal distribution</span>
<span class="sd">    (with ``scale=1/sqrt(2)``).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    laplace : Laplace distribution</span>
<span class="sd">    norm : normal distribution</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] &quot;Generalized normal distribution, Version 1&quot;,</span>
<span class="sd">           https://en.wikipedia.org/wiki/Generalized_normal_distribution#Version_1</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># evaluating (.5 + c) first prevents numerical cancellation</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincc</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1"># evaluating (1. + c) first prevents numerical cancellation</span>
        <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainccinv</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c5</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">([</span><span class="mf">1.</span><span class="o">/</span><span class="n">beta</span><span class="p">,</span> <span class="mf">3.</span><span class="o">/</span><span class="n">beta</span><span class="p">,</span> <span class="mf">5.</span><span class="o">/</span><span class="n">beta</span><span class="p">])</span>
        <span class="k">return</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c3</span> <span class="o">-</span> <span class="n">c1</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">c3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">gennorm</span> <span class="o">=</span> <span class="n">gennorm_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gennorm&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">halfgennorm_gen</span><span class="p">(</span><span class="n">rv_continuous</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The upper half of a generalized normal continuous random variable.</span>

<span class="sd">    %(before_notes)s</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The probability density function for `halfgennorm` is::</span>

<span class="sd">                                        beta</span>
<span class="sd">        halfgennorm.pdf(x, beta) =  -------------  exp(-|x|**beta)</span>
<span class="sd">                                    gamma(1/beta)</span>

<span class="sd">    `gennorm` takes ``beta`` as a shape parameter.</span>
<span class="sd">    For ``beta = 1``, it is identical to an exponential distribution.</span>
<span class="sd">    For ``beta = 2``, it is identical to a half normal distribution</span>
<span class="sd">    (with ``scale=1/sqrt(2)``).</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gennorm : generalized normal distribution</span>
<span class="sd">    expon : exponential distribution</span>
<span class="sd">    halfnorm : half normal distribution</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] &quot;Generalized normal distribution, Version 1&quot;,</span>
<span class="sd">           https://en.wikipedia.org/wiki/Generalized_normal_distribution#Version_1</span>

<span class="sd">    %(example)s</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="n">beta</span>

    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainc</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaincc</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_isf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">special</span><span class="o">.</span><span class="n">gammainccinv</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">halfgennorm</span> <span class="o">=</span> <span class="n">halfgennorm_gen</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;halfgennorm&#39;</span><span class="p">)</span>


<span class="c1"># Collect names of classes and objects in this module.</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">_distn_names</span><span class="p">,</span> <span class="n">_distn_gen_names</span> <span class="o">=</span> <span class="n">get_distribution_names</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">rv_continuous</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="n">_distn_names</span> <span class="o">+</span> <span class="n">_distn_gen_names</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Paul Hobson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>